(function(e){var t=typeof e=="undefined"?function(){}:e;typeof global!="undefined"&&(global.numeric=t),t.version="1.0.2",t.bench=function(t,n){var r,i,s,o;typeof n=="undefined"&&(n=15),s=1,r=new Date;for(;;){s*=2;for(o=s;o>3;o-=4)t(),t(),t(),t();while(o>0)t(),o--;i=new Date;if(i-r>n)break}for(o=s;o>3;o-=4)t(),t(),t(),t();while(o>0)t(),o--;return i=new Date,1e3*(3*s-1)/(i-r)},t.Function=Function,t.precision=4,t.largeArray=50,t.prettyPrint=function(n){function r(e){if(e===0)return"0";if(t.NisNaN(e))return"NaN";if(e<0)return"-"+r(-e);if(t.NisFinite(e)){var n=Math.floor(Math.log(e)/Math.log(10)),i=e/Math.pow(10,n),s=i.toPrecision(t.precision);return parseFloat(s)===10&&(n++,i=1,s=i.toPrecision(t.precision)),parseFloat(s).toString()+"e"+n.toString()}return"Infinity"}function s(e){var n;if(typeof e=="undefined")return i.push(Array(t.precision+8).join(" ")),!1;if(typeof e=="string")return i.push('"'+e+'"'),!1;if(typeof e=="boolean")return i.push(e.toString()),!1;if(typeof e=="number"){var o=r(e),u=e.toPrecision(t.precision),a=parseFloat(e.toString()).toString(),f=[o,u,a,parseFloat(u).toString(),parseFloat(a).toString()];for(n=1;n<f.length;n++)f[n].length<o.length&&(o=f[n]);return i.push(Array(t.precision+8-o.length).join(" ")+o),!1}if(e===null)return i.push("null"),!1;if(typeof e=="function"){i.push(e.toString());var l=!1;for(n in e)e.hasOwnProperty(n)&&(l?i.push(",\n"):i.push("\n{"),l=!0,i.push(n),i.push(": \n"),s(e[n]));return l&&i.push("}\n"),!0}if(e instanceof Array){if(e.length>t.largeArray)return i.push("...Large Array..."),!0;var l=!1;i.push("[");for(n=0;n<e.length;n++)n>0&&(i.push(","),l&&i.push("\n ")),l=s(e[n]);return i.push("]"),!0}i.push("{");var l=!1;for(n in e)e.hasOwnProperty(n)&&(l&&i.push(",\n"),l=!0,i.push(n),i.push(": \n"),s(e[n]));return i.push("}"),!0}var i=[];return s(n),i.join("")},t.parseDate=function(t){function n(e){if(typeof e=="string")return Date.parse(e.replace(/-/g,"/"));if(e instanceof Array){var t=[],r;for(r=0;r<e.length;r++)t[r]=n(e[r]);return t}throw new Error("parseDate: parameter must be arrays of strings")}return n(t)},t.parseFloat=function(t){function n(e){if(typeof e=="string")return parseFloat(e);if(e instanceof Array){var t=[],r;for(r=0;r<e.length;r++)t[r]=n(e[r]);return t}throw new Error("parseFloat: parameter must be arrays of strings")}return n(t)},t.parseCSV=function(t){var n=t.split("\n"),r,i,s=[],o=/(([^'",]*)|('[^']*')|("[^"]*")),/g,u=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,a=function(e){return e.substr(0,e.length-1)},f=0;for(i=0;i<n.length;i++){var l=(n[i]+",").match(o),c;if(l.length>0){s[f]=[];for(r=0;r<l.length;r++)c=a(l[r]),u.test(c)?s[f][r]=parseFloat(c):s[f][r]=c;f++}}return s},t.toCSV=function(n){var r=t.dim(n),i,s,o,u,a,f;o=r[0],u=r[1],f=[];for(i=0;i<o;i++){a=[];for(s=0;s<o;s++)a[s]=n[i][s].toString();f[i]=a.join(", ")}return f.join("\n")+"\n"},t.getURL=function(t){var n=new XMLHttpRequest;return n.open("GET",t,!1),n.send(),n},t.imageURL=function(t){function n(e){var t=e.length,n,r,i,s,o,u,a,f,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="";for(n=0;n<t;n+=3)r=e[n],i=e[n+1],s=e[n+2],o=r>>2,u=((r&3)<<4)+(i>>4),a=((i&15)<<2)+(s>>6),f=s&63,n+1>=t?a=f=64:n+2>=t&&(f=64),c+=l.charAt(o)+l.charAt(u)+l.charAt(a)+l.charAt(f);return c}function r(e,t,n){typeof t=="undefined"&&(t=0),typeof n=="undefined"&&(n=e.length);var r=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],i=-1,s=0,o=e.length,u;for(u=t;u<n;u++)s=(i^e[u])&255,i=i>>>8^r[s];return i^-1}var i=t[0].length,s=t[0][0].length,o,u,a,f,l,c,h,p,d,v,m,g=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,s>>24&255,s>>16&255,s>>8&255,s&255,i>>24&255,i>>16&255,i>>8&255,i&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];m=r(g,12,29),g[29]=m>>24&255,g[30]=m>>16&255,g[31]=m>>8&255,g[32]=m&255,o=1,u=0;for(p=0;p<i;p++){p<i-1?g.push(0):g.push(1),c=3*s+1+(p===0)&255,h=3*s+1+(p===0)>>8&255,g.push(c),g.push(h),g.push(~c&255),g.push(~h&255),p===0&&g.push(0);for(d=0;d<s;d++)for(f=0;f<3;f++)c=t[f][p][d],c>255?c=255:c<0?c=0:c=Math.round(c),o=(o+c)%65521,u=(u+o)%65521,g.push(c);g.push(0)}return v=(u<<16)+o,g.push(v>>24&255),g.push(v>>16&255),g.push(v>>8&255),g.push(v&255),l=g.length-41,g[33]=l>>24&255,g[34]=l>>16&255,g[35]=l>>8&255,g[36]=l&255,m=r(g,37),g.push(m>>24&255),g.push(m>>16&255),g.push(m>>8&255),g.push(m&255),g.push(0),g.push(0),g.push(0),g.push(0),g.push(73),g.push(69),g.push(78),g.push(68),g.push(174),g.push(66),g.push(96),g.push(130),"data:image/png;base64,"+n(g)},t._dim=function(t){var n=[];while(typeof t=="object")n.push(t.length),t=t[0];return n},t.dim=function(n){var r,i;if(typeof n=="object")return r=n[0],typeof r=="object"?(i=r[0],typeof i=="object"?t._dim(n):[n.length,r.length]):[n.length];return[]},t.mapreduce=function(n,r){return t.Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+r+";\n"+'if(typeof _s === "undefined") _s = numeric.dim(x);\n'+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i,xi;\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) {\n"+"        accum = arguments.callee(x[i],accum,_s,_k+1);\n"+"    }"+"    return accum;\n"+"}\n"+"for(i=_n-1;i>=1;i-=2) { \n"+"    xi = x[i];\n"+"    "+n+";\n"+"    xi = x[i-1];\n"+"    "+n+";\n"+"}\n"+"if(i === 0) {\n"+"    xi = x[i];\n"+"    "+n+"\n"+"}\n"+"return accum;")},t.same=function r(e,t){var n,i;if(e instanceof Array&&t instanceof Array){i=e.length;if(i!==t.length)return!1;for(n=0;n<i;n++){if(e[n]===t[n])continue;if(typeof e[n]!="object")return!1;if(!r(e[n],t[n]))return!1}return!0}return!1},t.rep=function(n,r,i){typeof i=="undefined"&&(i=0);var s=n[i],o=Array(s),u;if(i===n.length-1){for(u=s-2;u>=0;u-=2)o[u+1]=r,o[u]=r;return u===-1&&(o[0]=r),o}for(u=s-1;u>=0;u--)o[u]=t.rep(n,r,i+1);return o},t.dotMMbig=function(n,r){var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x=t.dotVV,T=Math.min;u=n.length,a=r.length,f=r[0].length,l=Array(u),p=t.transpose(r);for(d=0;d<u;d+=4){m=T(d+4,u);for(i=d;i<m;i++)l[i]=Array(f);for(v=0;v<f;v+=4){g=T(v+4,f);for(i=d;i<m;i++){h=n[i],c=l[i];for(o=v;o<g;o++)c[o]=x(h,p[o])}}}return l},t.dotMMsmall=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m;o=t.length,u=n.length,a=n[0].length,f=Array(o);for(r=o-1;r>=0;r--){l=Array(a),c=t[r];for(s=a-1;s>=0;s--){h=c[u-1]*n[u-1][s];for(i=u-2;i>=1;i-=2)p=i-1,h+=c[i]*n[i][s]+c[p]*n[p][s];i===0&&(h+=c[0]*n[0][s]),l[s]=h}f[r]=l}return f},t.dotMV=function(n,r){var i=n.length,s=r.length,o,u=Array(i),a=t.dotVV;for(o=i-1;o>=0;o--)u[o]=a(n[o],r);return u},t.dotVM=function(t,n){var r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E;o=t.length,u=n[0].length,f=Array(u);for(s=u-1;s>=0;s--){h=t[o-1]*n[o-1][s];for(i=o-2;i>=1;i-=2)p=i-1,h+=t[i]*n[i][s]+t[p]*n[p][s];i===0&&(h+=t[0]*n[0][s]),f[s]=h}return f},t.dotVV=function(t,n){var r,i=t.length,s,o=t[i-1]*n[i-1];for(r=i-2;r>=1;r-=2)s=r-1,o+=t[r]*n[r]+t[s]*n[s];return r===0&&(o+=t[0]*n[0]),o},t.dot=function(n,r){var i=t.dim;switch(i(n).length*1e3+i(r).length){case 2002:return r.length<40?t.dotMMsmall(n,r):t.dotMMbig(n,r);case 2001:return t.dotMV(n,r);case 1002:return t.dotVM(n,r);case 1001:return t.dotVV(n,r);case 1e3:return t.mulVS(n,r);case 1:return t.mulSV(n,r);case 0:return n*r;default:throw new Error("numeric.dot only works on vectors and matrices")}},t.diag=function(t){var n,r,i,s=t.length,o=Array(s),u;for(n=s-1;n>=0;n--){u=Array(s),r=n+2;for(i=s-1;i>=r;i-=2)u[i]=0,u[i-1]=0;i>n&&(u[i]=0),u[n]=t[n];for(i=n-1;i>=1;i-=2)u[i]=0,u[i-1]=0;i===0&&(u[0]=0),o[n]=u}return o},t.getDiag=function(e){var t=Math.min(e.length,e[0].length),n,r=Array(t);for(n=t-1;n>=1;--n)r[n]=e[n][n],--n,r[n]=e[n][n];return n===0&&(r[0]=e[0][0]),r},t.identity=function(n){return t.diag(t.rep([n],1))},t.pointwise=function(n,r,i){typeof i=="undefined"&&(i="");var s=[],o,u=/\[i\]$/,a,f="";for(o=0;o<n.length;o++)u.test(n[o])?(a=n[o].substring(0,n[o].length-3),f=a):a=n[o],s.push(a);return s[n.length]="_s",s[n.length+1]="_k",s[n.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+f+");\n"+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i, ret = Array(_n);\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+n.join(",")+",_s,_k+1);\n"+"    return ret;\n"+"}\n"+i+"\n"+"for(i=_n-1;i>=3;--i) { \n"+"    "+r+"\n"+"    --i;\n"+"    "+r+"\n"+"    --i;\n"+"    "+r+"\n"+"    --i;\n"+"    "+r+"\n"+"}\n"+"while(i>=0) {\n"+"    "+r+"\n"+"    --i;\n"+"}\n"+"return ret;",t.Function.apply(null,s)},t._biforeach=function i(e,t,n,r,s){if(r===n.length-1){s(e,t);return}var o,u=n[r];for(o=u-1;o>=0;o--)i(e[o],t[o],n,r+1,s)},t.anyV=t.mapreduce("if(xi) return true;","false"),t.allV=t.mapreduce("if(!xi) return false;","true"),t.any=function(e){return typeof e.length=="undefined"?e:t.anyV(e)},t.all=function(e){return typeof e.length=="undefined"?e:t.allV(e)},t.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},t.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",andeq:"&=",oreq:"|=",xoreq:"^="},t.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"],t.ops1={neg:"-",not:"!",bnot:"~"},function(){var e,n;for(e in t.ops2)t.ops2.hasOwnProperty(e)&&(n=t.ops2[e],t[e+"VV"]=t.pointwise(["x[i]","y[i]"],"ret[i] = x[i] "+n+" y[i];"),t[e+"SV"]=t.pointwise(["x","y[i]"],"ret[i] = x "+n+" y[i];"),t[e+"VS"]=t.pointwise(["x[i]","y"],"ret[i] = x[i] "+n+" y;"),t[e]=t.Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+e+"VV, VS = numeric."+e+"VS, SV = numeric."+e+"SV;\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];"+'  if(typeof x === "object") {\n'+'      if(typeof y === "object") x = VV(x,y);\n'+"      else x = VS(x,y);\n"+'  } else if(typeof y === "object") x = SV(x,y);\n'+"  else x = x "+n+" y;\n"+"}\nreturn x;\n"),t[n]=t[e]);for(e in t.ops1)t.ops1.hasOwnProperty(e)&&(n=t.ops1[e],t[e+"V"]=t.pointwise(["x[i]"],"ret[i] = "+n+"x[i];"),t[e]=t.Function("x",'if(typeof x === "object") return numeric.'+e+"V(x);\nreturn "+n+"(x);"));for(e=0;e<t.mathfuns.length;e++)n=t.mathfuns[e],t[n+"V"]=t.pointwise(["x[i]"],"ret[i] = fun(x[i]);","var fun = Math."+n+";"),t[n]=t.Function("x",'if(typeof x === "object") return numeric.'+n+"V(x);\nreturn Math."+n+"(x);");t.NisNaNV=t.pointwise(["x[i]"],"ret[i] = isNaN(x[i]);"),t.NisNaN=function(e){return typeof e=="object"?isNaNV(e):isNaN(e)},t.NisFiniteV=t.pointwise(["x[i]"],"ret[i] = numeric.NisFinite(x[i]);"),t.NisFinite=function(e){return typeof e=="object"?t.NisFiniteV(e):t.NisFinite(e)};for(e in t.opseq)t.opseq.hasOwnProperty(e)&&(t[e+"S"]=t.Function("x","y","var n = x.length, i;\nfor(i=n-1;i>=0;i--) x[i] "+t.opseq[e]+" y;"),t[e+"V"]=t.Function("x","y","var n = x.length, i;\nfor(i=n-1;i>=0;i--) x[i] "+t.opseq[e]+" y[i];"),t[e]=t.Function("x","y",'var s = numeric.dim(x);\nif(typeof y === "number") { numeric._biforeach(x,y,s,0,numeric.'+e+"S); return x; }\n"+"numeric._biforeach(x,y,s,0,numeric."+e+"V);\n"+"return x;"),t[t.opseq[e]]=t[e])}(),t.atan2VV=t.pointwise(["x[i]","y[i]"],"ret[i] = atan2(x[i],y[i]);","var atan2 = Math.atan2;"),t.atan2VS=t.pointwise(["x[i]","y"],"ret[i] = atan2(x[i],y);","var atan2 = Math.atan2;"),t.atan2SV=t.pointwise(["x","y[i]"],"ret[i] = atan2(x,y[i]);","var atan2 = Math.atan2;"),t.atan2=function(n,r){return typeof n=="object"?typeof r=="object"?t.atan2VV(n,r):t.atan2VS(n,r):typeof r=="object"?t.atan2SV(n,r):Math.atan2(n,r)},t.powVV=t.pointwise(["x[i]","y[i]"],"ret[i] = pow(x[i],y[i]);","var pow = Math.pow;"),t.powVS=t.pointwise(["x[i]","y"],"ret[i] = pow(x[i],y);","var pow = Math.pow;"),t.powSV=t.pointwise(["x","y[i]"],"ret[i] = pow(x,y[i]);","var pow = Math.pow;"),t.pow=function(n,r){return typeof n=="object"?typeof r=="object"?t.powVV(n,r):t.powVS(n,r):typeof r=="object"?t.powSV(n,r):Math.pow(n,r)},t.clone=t.pointwise(["x[i]"],"ret[i] = x[i];"),t.inv=function(n){var r=t.dim(n),i=Math.abs;if(r.length!==2||r[0]!==r[1])throw new Error("numeric: inv() only works on square matrices");var s=r[0],o=t.identity(s),u,a,f,l=t.clone(n),c,h,p,d,v,m,g,y,b,w,E=t.linspace(0,s-1),S=t.rep([s],0);for(a=0;a<s-1;a++){f=a;for(u=a+1;u<s;u++)i(l[u][a])>i(l[f][a])&&(f=u);f!==a&&(m=l[f],l[f]=l[a],l[a]=m,m=o[f],o[f]=o[a],o[a]=m,m=E[f],E[f]=E[a],E[a]=m),c=l[a],p=o[a];for(u=a+1;u<s;u++){h=l[u],d=o[u],v=h[a]/c[a];if(v===0)continue;for(f=a+1;f<s-1;f+=2)y=f+1,h[f]-=c[f]*v,h[y]-=c[y]*v;f<s&&(h[f]-=c[f]*v);for(f=a;f>=1;f-=2)b=E[f-1],w=E[f],d[b]-=p[b]*v,d[w]-=p[w]*v;f>=0&&(d[E[f]]-=p[E[f]]*v)}}for(a=s-1;a>0;a--){c=l[a],p=o[a];for(u=0;u<a;u++){d=o[u],v=l[u][a]/c[a];if(v===0)continue;for(f=0;f<s-1;f+=2)y=f+1,d[f]-=p[f]*v,d[y]-=p[y]*v;f!==s&&(d[f]-=p[f]*v)}}for(u=0;u<s;u++){v=l[u][u];if(v===1)continue;d=o[u];for(a=0;a<s;a++)d[a]/=v}return o},t.det=function(n){var r=t.dim(n);if(r.length!==2||r[0]!==r[1])throw new Error("numeric: det() only works on square matrices");var i=r[0],s=1,o,u,a,f=t.clone(n),l,c,h,p,d,v,m;for(u=0;u<i-1;u++){a=u;for(o=u+1;o<i;o++)Math.abs(f[o][u])>Math.abs(f[a][u])&&(a=o);a!==u&&(p=f[a],f[a]=f[u],f[u]=p,s*=-1),l=f[u];for(o=u+1;o<i;o++){c=f[o],h=c[u]/l[u];for(a=u+1;a<i-1;a+=2)d=a+1,c[a]-=l[a]*h,c[d]-=l[d]*h;a!==i&&(c[a]-=l[a]*h)}if(l[u]===0)return 0;s*=l[u]}return s*f[u][u]},t.transpose=function(t){var n,r,i=t.length,s=t[0].length,o=Array(s),u,a,f;for(r=0;r<s;r++)o[r]=Array(i);for(n=i-1;n>=1;n-=2){a=t[n],u=t[n-1];for(r=s-1;r>=1;--r)f=o[r],f[n]=a[r],f[n-1]=u[r],--r,f=o[r],f[n]=a[r],f[n-1]=u[r];r===0&&(f=o[0],f[n]=a[0],f[n-1]=u[0])}if(n===0){u=t[0];for(r=s-1;r>=1;--r)o[r][0]=u[r],--r,o[r][0]=u[r];r===0&&(o[0][0]=u[0])}return o},t.negtranspose=function(t){var n,r,i=t.length,s=t[0].length,o=Array(s),u,a,f;for(r=0;r<s;r++)o[r]=Array(i);for(n=i-1;n>=1;n-=2){a=t[n],u=t[n-1];for(r=s-1;r>=1;--r)f=o[r],f[n]=-a[r],f[n-1]=-u[r],--r,f=o[r],f[n]=-a[r],f[n-1]=-u[r];r===0&&(f=o[0],f[n]=-a[0],f[n-1]=-u[0])}if(n===0){u=t[0];for(r=s-1;r>=1;--r)o[r][0]=-u[r],--r,o[r][0]=-u[r];r===0&&(o[0][0]=-u[0])}return o},t._random=function s(e,t){var n,r=e[t],i=Array(r),o;if(t===e.length-1){o=Math.random;for(n=r-1;n>=1;n-=2)i[n]=o(),i[n-1]=o();return n===0&&(i[0]=o()),i}for(n=r-1;n>=0;n--)i[n]=s(e,t+1);return i},t.random=function(n){return t._random(n,0)},t.norm2Squared=function(t){},t.norm2Squared=t.mapreduce("accum += xi*xi;","0"),t.norm2=function(n){return Math.sqrt(t.norm2Squared(n))},t.norminf=t.mapreduce("accum = max(abs(xi),accum);","0; var max = Math.max, abs = Math.abs;"),t.sum=t.mapreduce("accum += xi;","0"),t.linspace=function(t,n,r){typeof r=="undefined"&&(r=Math.round(n-t)+1);var i,s=Array(r);r--;for(i=r;i>=0;i--)s[i]=(i*n+(r-i)*t)/r;return s},t.getBlock=function(n,r,i){function o(e,t){var n,u=r[t],a=i[t]-u,f=Array(a);if(t===s.length-1){for(n=a;n>=0;n--)f[n]=e[n+u];return f}for(n=a;n>=0;n--)f[n]=o(e[n+u],t+1);return f}var s=t.dim(n);return o(n,0)},t.setBlock=function(n,r,i,s){function u(e,t,n){var s,a=r[n],f=i[n]-a;if(n===o.length-1)for(s=f;s>=0;s--)e[s+a]=t[s];for(s=f;s>=0;s--)u(e[s+a],t[s],n+1)}var o=t.dim(n);return u(n,s,0),n},t.tensor=function(n,r){if(typeof n=="number"||typeof r=="number")return t.mul(n,r);var i=t.dim(n),s=t.dim(r);if(i.length!==1||s.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var o=i[0],u=s[0],a=Array(o),f,l,c,h;for(l=o-1;l>=0;l--){f=Array(u),h=n[l];for(c=u-1;c>=3;--c)f[c]=h*r[c],--c,f[c]=h*r[c],--c,f[c]=h*r[c],--c,f[c]=h*r[c];while(c>=0)f[c]=h*r[c],--c;a[l]=f}return a},t.T=function(t,n){this.x=t,this.y=n},t.t=function(n,r){return new t.T(n,r)},t.Tbinop=function(n,r,i,s,o){var u=t.indexOf;if(typeof o!="string"){var a;o="";for(a in t)t.hasOwnProperty(a)&&(n.indexOf(a)>=0||r.indexOf(a)>=0||i.indexOf(a)>=0||s.indexOf(a)>=0)&&a.length>1&&(o+="var "+a+" = numeric."+a+";\n")}return t.Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+o+"\n"+"if(x.y) {"+"  if(y.y) {"+"    return new numeric.T("+s+");\n"+"  }\n"+"  return new numeric.T("+i+");\n"+"}\n"+"if(y.y) {\n"+"  return new numeric.T("+r+");\n"+"}\n"+"return new numeric.T("+n+");\n")},t.T.prototype.add=t.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),t.T.prototype.sub=t.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),t.T.prototype.mul=t.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),t.T.prototype.reciprocal=function(){var n=t.mul,r=t.div;if(this.y){var i=t.add(n(this.x,this.x),n(this.y,this.y));return new t.T(r(this.x,i),r(t.neg(this.y),i))}return new T(r(1,this.x))},t.T.prototype.div=function o(e){e instanceof t.T||(e=new t.T(e));if(e.y)return this.mul(e.reciprocal());var o=t.div;return this.y?new t.T(o(this.x,e.x),o(this.y,e.x)):new t.T(o(this.x,e.x))},t.T.prototype.dot=t.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),t.T.prototype.transpose=function(){var n=t.transpose,r=this.x,i=this.y;return i?new t.T(n(r),n(i)):new t.T(n(r))},t.T.prototype.transjugate=function(){var n=t.transpose,r=this.x,i=this.y;return i?new t.T(n(r),t.negtranspose(i)):new t.T(n(r))},t.Tunop=function(n,r,i){return typeof i!="string"&&(i=""),t.Function("var x = this;\n"+i+"\n"+"if(x.y) {"+"  "+r+";\n"+"}\n"+n+";\n")},t.T.prototype.exp=t.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),t.T.prototype.conj=t.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),t.T.prototype.neg=t.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),t.T.prototype.sin=t.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),t.T.prototype.cos=t.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),t.T.prototype.abs=t.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),t.T.prototype.log=t.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),t.T.prototype.norm2=t.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),t.T.prototype.inv=function(){var n=this;if(typeof n.y=="undefined")return new t.T(t.inv(n.x));var r=n.x.length,i,s,o,u=t.identity(r),a=t.rep([r,r],0),f=t.clone(n.x),l=t.clone(n.y),c,h,p,d,v,m,g,y,i,s,o,b,w,E,S,x,T,N;for(i=0;i<r;i++){E=f[i][i],S=l[i][i],b=E*E+S*S,o=i;for(s=i+1;s<r;s++)E=f[s][i],S=l[s][i],w=E*E+S*S,w>b&&(o=s,b=w);o!==i&&(N=f[i],f[i]=f[o],f[o]=N,N=l[i],l[i]=l[o],l[o]=N,N=u[i],u[i]=u[o],u[o]=N,N=a[i],a[i]=a[o],a[o]=N),c=f[i],h=l[i],v=u[i],m=a[i],E=c[i],S=h[i];for(s=i+1;s<r;s++)x=c[s],T=h[s],c[s]=(x*E+T*S)/b,h[s]=(T*E-x*S)/b;for(s=0;s<r;s++)x=v[s],T=m[s],v[s]=(x*E+T*S)/b,m[s]=(T*E-x*S)/b;for(s=i+1;s<r;s++){p=f[s],d=l[s],g=u[s],y=a[s],E=p[i],S=d[i];for(o=i+1;o<r;o++)x=c[o],T=h[o],p[o]-=x*E-T*S,d[o]-=T*E+x*S;for(o=0;o<r;o++)x=v[o],T=m[o],g[o]-=x*E-T*S,y[o]-=T*E+x*S}}for(i=r-1;i>0;i--){v=u[i],m=a[i];for(s=i-1;s>=0;s--){g=u[s],y=a[s],E=f[s][i],S=l[s][i];for(o=r-1;o>=0;o--)x=v[o],T=m[o],g[o]-=E*x-S*T,y[o]-=E*T+S*x}}return new t.T(u,a)},t.T.prototype.get=function(n){var r=this.x,i=this.y,s=0,o,u=n.length;if(i){while(s<u)o=n[s],r=r[o],i=i[o],s++;return new t.T(r,i)}while(s<u)o=n[s],r=r[o],s++;return new t.T(r)},t.T.prototype.set=function(n,r){var i=this.x,s=this.y,o=0,u,a=n.length,f=r.x,l=r.y;if(a===0)return l?this.y=l:s&&(this.y=undefined),this.x=i,this;if(l){s||(s=t.rep(t.dim(i),0),this.y=s);while(o<a-1)u=n[o],i=i[u],s=s[u],o++;return u=n[o],i[u]=f,s[u]=l,this}if(s){while(o<a-1)u=n[o],i=i[u],s=s[u],o++;return u=n[o],i[u]=f,f instanceof Array?s[u]=t.rep(t.dim(f),0):s[u]=0,this}while(o<a-1)u=n[o],i=i[u],o++;return u=n[o],i[u]=f,this},t.T.prototype.getRows=function(n,r){var i=r-n+1,s,o=Array(i),u,a=this.x,f=this.y;for(s=n;s<=r;s++)o[s-n]=a[s];if(f){u=Array(i);for(s=n;s<=r;s++)u[s-n]=f[s];return new t.T(o,u)}return new t.T(o)},t.T.prototype.setRows=function(n,r,i){var s,o=this.x,u=this.y,a=i.x,f=i.y;for(s=n;s<=r;s++)o[s]=a[s-n];if(f){u||(u=t.rep(t.dim(o),0),this.y=u);for(s=n;s<=r;s++)u[s]=f[s-n]}else if(u)for(s=n;s<=r;s++)u[s]=t.rep([a[s-n].length],0);return this},t.T.prototype.getRow=function(n){var r=this.x,i=this.y;return i?new t.T(r[n],i[n]):new t.T(r[n])},t.T.prototype.setRow=function(n,r){var i=this.x,s=this.y,o=r.x,u=r.y;return i[n]=o,u?(s||(s=t.rep(t.dim(i),0),this.y=s),s[n]=u):s&&(s=t.rep([o.length],0)),this},t.T.prototype.getBlock=function(n,r){var i=this.x,s=this.y,o=t.getBlock;return s?new t.T(o(i,n,r),o(s,n,r)):new t.T(o(i,n,r))},t.T.prototype.setBlock=function(n,r,i){i instanceof t.T||(i=new t.T(i));var s=this.x,o=this.y,u=t.setBlock,a=i.x,f=i.y;if(f)return o||(this.y=t.rep(t.dim(this),0),o=this.y),u(s,n,r,a),u(o,n,r,f),this;u(s,n,r,a),o&&u(o,n,r,t.rep(t.dim(a),0))},t.T.rep=function(n,r){var i=t.T;r instanceof i||(r=new i(r));var s=r.x,o=r.y,u=t.rep;return o?new i(u(n,s),u(n,o)):new i(u(n,s))},t.T.diag=function u(e){e instanceof t.T||(e=new t.T(e));var n=e.x,r=e.y,u=t.diag;return r?new t.T(u(n),u(r)):new t.T(u(n))},t.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return t.eig(this.x)},t.T.identity=function(n){return new t.T(t.identity(n))},t.T.prototype.getDiag=function(){var n=t,r=this.x,i=this.y;return i?new n.T(n.getDiag(r),n.getDiag(i)):new n.T(n.getDiag(r))},t.house=function(n){var r=t.clone(n),i=n[0]>=0?1:-1,s=i*t.norm2(n);r[0]+=s;var o=t.norm2(r);if(o===0)throw new Error("eig: internal error");return t.div(r,o)},t.toUpperHessenberg=function(n){var r=t.dim(n);if(r.length!==2||r[0]!==r[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var i=r[0],s,o,u,a,f,l=t.clone(n),c,h,p,d,v=t.identity(i),m;for(o=0;o<i-2;o++){a=Array(i-o-1);for(s=o+1;s<i;s++)a[s-o-1]=l[s][o];f=t.house(a),c=t.getBlock(l,[o+1,o],[i-1,i-1]),h=t.tensor(f,t.dot(f,c));for(s=o+1;s<i;s++){p=l[s],d=h[s-o-1];for(u=o;u<i;u++)p[u]-=2*d[u-o]}c=t.getBlock(l,[0,o+1],[i-1,i-1]),h=t.tensor(t.dot(c,f),f);for(s=0;s<i;s++){p=l[s],d=h[s];for(u=o+1;u<i;u++)p[u]-=2*d[u-o-1]}c=Array(i-o-1);for(s=o+1;s<i;s++)c[s-o-1]=v[s];h=t.tensor(f,t.dot(f,c));for(s=o+1;s<i;s++){m=v[s],d=h[s-o-1];for(u=0;u<i;u++)m[u]-=2*d[u]}}return{H:l,Q:v}},t.epsilon=2.220446049250313e-16,t.QRFrancis=function(e,n){typeof n=="undefined"&&(n=1e4),e=t.clone(e);var r=t.clone(e),i=t.dim(e),s=i[0],o,u,a,f,l,c,h,p,d,v=t.identity(s),m,g,y,b,w,E,S,x,T;if(s<3)return{Q:v,B:[[0,s-1]]};var N=t.epsilon;for(T=0;T<n;T++){for(S=0;S<s-1;S++)if(Math.abs(e[S+1][S])<N*(Math.abs(e[S][S])+Math.abs(e[S+1][S+1]))){var C=t.QRFrancis(t.getBlock(e,[0,0],[S,S]),n),k=t.QRFrancis(t.getBlock(e,[S+1,S+1],[s-1,s-1]),n);y=Array(S+1);for(E=0;E<=S;E++)y[E]=v[E];b=t.dot(C.Q,y);for(E=0;E<=S;E++)v[E]=b[E];y=Array(s-S-1);for(E=S+1;E<s;E++)y[E-S-1]=v[E];b=t.dot(k.Q,y);for(E=S+1;E<s;E++)v[E]=b[E-S-1];return{Q:v,B:C.B.concat(t.add(k.B,S+1))}}a=e[s-2][s-2],f=e[s-2][s-1],l=e[s-1][s-2],c=e[s-1][s-1],p=a+c,h=a*c-f*l,d=t.getBlock(e,[0,0],[2,2]);if(p*p>=4*h){var L,A;L=.5*(p+Math.sqrt(p*p-4*h)),A=.5*(p-Math.sqrt(p*p-4*h)),d=t.add(t.sub(t.dot(d,d),t.mul(d,L+A)),t.diag(t.rep([3],L*A)))}else d=t.add(t.sub(t.dot(d,d),t.mul(d,p)),t.diag(t.rep([3],h)));o=[d[0][0],d[1][0],d[2][0]],u=t.house(o),y=[e[0],e[1],e[2]],b=t.tensor(u,t.dot(u,y));for(E=0;E<3;E++){g=e[E],w=b[E];for(x=0;x<s;x++)g[x]-=2*w[x]}y=t.getBlock(e,[0,0],[s-1,2]),b=t.tensor(t.dot(y,u),u);for(E=0;E<s;E++){g=e[E],w=b[E];for(x=0;x<3;x++)g[x]-=2*w[x]}y=[v[0],v[1],v[2]],b=t.tensor(u,t.dot(u,y));for(E=0;E<3;E++){m=v[E],w=b[E];for(x=0;x<s;x++)m[x]-=2*w[x]}var O;for(S=0;S<s-2;S++){for(x=S;x<=S+1;x++)if(Math.abs(e[x+1][x])<N*(Math.abs(e[x][x])+Math.abs(e[x+1][x+1]))){var C=t.QRFrancis(t.getBlock(e,[0,0],[x,x]),n),k=t.QRFrancis(t.getBlock(e,[x+1,x+1],[s-1,s-1]),n);y=Array(x+1);for(E=0;E<=x;E++)y[E]=v[E];b=t.dot(C.Q,y);for(E=0;E<=x;E++)v[E]=b[E];y=Array(s-x-1);for(E=x+1;E<s;E++)y[E-x-1]=v[E];b=t.dot(k.Q,y);for(E=x+1;E<s;E++)v[E]=b[E-x-1];return{Q:v,B:C.B.concat(t.add(k.B,x+1))}}O=Math.min(s-1,S+3),o=Array(O-S);for(E=S+1;E<=O;E++)o[E-S-1]=e[E][S];u=t.house(o),y=t.getBlock(e,[S+1,S],[O,s-1]),b=t.tensor(u,t.dot(u,y));for(E=S+1;E<=O;E++){g=e[E],w=b[E-S-1];for(x=S;x<s;x++)g[x]-=2*w[x-S]}y=t.getBlock(e,[0,S+1],[s-1,O]),b=t.tensor(t.dot(y,u),u);for(E=0;E<s;E++){g=e[E],w=b[E];for(x=S+1;x<=O;x++)g[x]-=2*w[x-S-1]}y=Array(O-S);for(E=S+1;E<=O;E++)y[E-S-1]=v[E];b=t.tensor(u,t.dot(u,y));for(E=S+1;E<=O;E++){m=v[E],w=b[E-S-1];for(x=0;x<s;x++)m[x]-=2*w[x]}}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},t.eig=function(n,r){var i=t.toUpperHessenberg(n),s=t.QRFrancis(i.H,r),o=t.T,u=n.length,a,f,l=!1,c=s.B,h=t.dot(s.Q,t.dot(i.H,t.transpose(s.Q))),p=new o(t.dot(s.Q,i.Q)),d,v=c.length,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O=Math.sqrt;for(f=0;f<v;f++){a=c[f][0];if(a!==c[f][1]){m=a+1,g=h[a][a],y=h[a][m],b=h[m][a],w=h[m][m];if(y===0&&b===0)continue;E=-g-w,S=g*w-y*b,x=E*E-4*S,x>=0?(E<0?T=-0.5*(E-O(x)):T=-0.5*(E+O(x)),L=(g-T)*(g-T)+y*y,A=b*b+(w-T)*(w-T),L>A?(L=O(L),C=(g-T)/L,k=y/L):(A=O(A),C=b/A,k=(w-T)/A),d=new o([[k,-C],[C,k]]),p.setRows(a,m,d.dot(p.getRows(a,m)))):(T=-0.5*E,N=.5*O(-x),L=(g-T)*(g-T)+y*y,A=b*b+(w-T)*(w-T),L>A?(L=O(L+N*N),C=(g-T)/L,k=y/L,T=0,N/=L):(A=O(A+N*N),C=b/A,k=(w-T)/A,T=N/A,N=0),d=new o([[k,-C],[C,k]],[[T,N],[N,-T]]),p.setRows(a,m,d.dot(p.getRows(a,m))))}}var M=p.dot(n).dot(p.transjugate()),u=n.length,_=t.T.identity(u);for(m=0;m<u;m++)if(m>0)for(f=m-1;f>=0;f--){var D=M.get([f,f]),P=M.get([m,m]);if(!t.neq(D.x,P.x)&&!t.neq(D.y,P.y)){_.setRow(m,_.getRow(f));continue}T=M.getRow(f).getBlock([f],[m-1]),N=_.getRow(m).getBlock([f],[m-1]),_.set([m,f],M.get([f,m]).neg().sub(T.dot(N)).div(D.sub(P)))}for(m=0;m<u;m++)T=_.getRow(m),_.setRow(m,T.div(T.norm2()));return _=_.transpose(),_=p.transjugate().dot(_),{lambda:M.getDiag(),E:_}},t.sdim=function a(e,t,n){typeof t=="undefined"&&(t=[]);if(typeof e!="object")return t;typeof n=="undefined"&&(n=0),n in t||(t[n]=0),e.length>t[n]&&(t[n]=e.length);var r;for(r in e)e.hasOwnProperty(r)&&a(e[r],t,n+1);return t},t.sclone=function f(e,n,r){typeof n=="undefined"&&(n=0),typeof r=="undefined"&&(r=t.sdim(e).length);var i,s=Array(e.length);if(n===r-1){for(i in e)e.hasOwnProperty(i)&&(s[i]=e[i]);return s}for(i in e)e.hasOwnProperty(i)&&(s[i]=f(e[i],n+1,r));return s},t.sdiag=function(t){var n=t.length,r,i=Array(n),s,o,u;for(r=n-1;r>=1;r-=2)s=r-1,i[r]=[],i[r][r]=t[r],i[s]=[],i[s][s]=t[s];return r===0&&(i[0]=[],i[0][0]=t[r]),i},t.sidentity=function(n){return t.sdiag(t.rep([n],1))},t.stranspose=function(t){var n=[],r=t.length,i,s,o;for(i in t){if(!t.hasOwnProperty(i))continue;o=t[i];for(s in o){if(!o.hasOwnProperty(s))continue;typeof n[s]!="object"&&(n[s]=[]),n[s][i]=o[s]}}return n},t.sLUP=function(n,r){typeof r=="undefined"&&(r=1);var i=n.length,s,o,u,a=t.sidentity(i),f=t.sclone(n),l=t.stranspose(f),c=t.linspace(0,i-1),h=t.linspace(0,i-1),p,d,v,m,g,y=Math.abs;for(s=0;s<i-1;s++){v=l[s],o=s;for(u in v){if(!h.hasOwnProperty(u))continue;u=h[u];if(u<=s)continue;y(f[u][s])>y(f[o][s])&&(o=u)}y(f[s][s])>=r*y(f[o][s])&&(o=s);if(o!==s){m=f[s],f[s]=f[o],f[o]=m,m=a[s],a[s]=a[o],a[o]=m,m=c[s],c[s]=c[o],c[o]=m,h=Array(i);for(o=0;o<i;o++)h[c[o]]=o}p=f[s];for(o in v){if(!h.hasOwnProperty(o))continue;o=h[o];if(o<=s)continue;d=f[o],g=d[s]/p[s],a[o][s]=g;for(u in p){if(!p.hasOwnProperty(u))continue;u>s?(u in d||(d[u]=0,l[u][o]=0),d[u]-=g*p[u]):delete d[u]}}}return{L:a,U:f,P:c,Pinv:h}},t.sdotMM=function(n,r){var i=n.length,s=r.length,o=t.stranspose(r),u=o.length,a,f,l,c,h,p,d=Array(i),v;for(l=i-1;l>=0;l--){v=[],a=n[l];for(h=u-1;h>=0;h--){p=0,f=o[h];for(c in a){if(!a.hasOwnProperty(c))continue;c in f&&(p+=a[c]*f[c])}p&&(v[h]=p)}d[l]=v}return d},t.sdotMV=function(t,n){var r=t.length,i,s,o,u=Array(r),a;for(s=r-1;s>=0;s--){i=t[s],a=0;for(o in i){if(!i.hasOwnProperty(o))continue;n[o]&&(a+=i[o]*n[o])}a&&(u[s]=a)}return u},t.sdotVM=function(t,n){var r,i,s,o,u=[],a;for(r in t){if(!t.hasOwnProperty(r))continue;s=n[r],o=t[r];for(i in s){if(!s.hasOwnProperty(i))continue;u[i]||(u[i]=0),u[i]+=o*s[i]}}return u},t.sdotVV=function(t,n){var r,i=0;for(r in t)t[r]&&n[r]&&(i+=t[r]*n[r]);return i},t.sdot=function(n,r){var i=t.sdim(n).length,s=t.sdim(r).length,o=i*1e3+s;switch(o){case 0:return n*r;case 1001:return t.sdotVV(n,r);case 2001:return t.sdotMV(n,r);case 1002:return t.sdotVM(n,r);case 2002:return t.sdotMM(n,r);default:throw new Error("numeric.sdot not implemented for tensors of order "+i+" and "+s)}},t.sLUPsolve=function(t,n){var r=t.L,i=t.U,s=t.P,o=r.length,u,a,f=Array(o),l,c,h;for(u=0;u<o;u++){n.hasOwnProperty(s[u])?l=n[s[u]]:l=0,c=r[u];for(a in c){if(!c.hasOwnProperty(a))continue;a<u&&(l-=c[a]*f[a])}f[u]=l}for(u=o-1;u>=0;u--){l=f[u],c=i[u];for(a in c){if(!c.hasOwnProperty(a))continue;a>u&&(l-=c[a]*f[a])}f[u]=l/c[u]}return f},t.sscatter=function(t){var n=t[0].length,r,i,s,o=t.length,u=[],a;for(i=n-1;i>=0;--i){if(!t[o-1][i])continue;a=u;for(s=0;s<o-2;s++)r=t[s][i],a[r]||(a[r]=[]),a=a[r];a[t[s][i]]=t[s+1][i]}return u},t.sgather=function l(e,t,n){typeof t=="undefined"&&(t=[]),typeof n=="undefined"&&(n=[]);var r,i,s;r=n.length;for(i in e)if(e.hasOwnProperty(i)){n[r]=parseInt(i),s=e[i];if(typeof s=="number"){if(s){if(t.length===0)for(i=r+1;i>=0;--i)t[i]=[];for(i=r;i>=0;--i)t[i].push(n[i]);t[r+1].push(s)}}else l(s,t,n)}return n.length>r&&n.pop(),t},t.cLU=function(n){var r=n[0],i=n[1],s=n[2],o=r.length,u=0,a,f,l,c,h,p;for(a=0;a<o;a++)r[a]>u&&(u=r[a]);u++;var d=Array(u),v=Array(u),m=t.rep([u],Infinity),g=t.rep([u],-Infinity),y,b,w;for(l=0;l<o;l++)a=r[l],f=i[l],f<m[a]&&(m[a]=f),f>g[a]&&(g[a]=f);for(a=0;a<u-1;a++)g[a]>g[a+1]&&(g[a+1]=g[a]);for(a=u-1;a>=1;a--)m[a]<m[a-1]&&(m[a-1]=m[a]);var E=0,S=0;for(a=0;a<u;a++)v[a]=t.rep([g[a]-m[a]+1],0),d[a]=t.rep([a-m[a]],0),E+=a-m[a]+1,S+=g[a]-a+1;for(l=0;l<o;l++)a=r[l],v[a][i[l]-m[a]]=s[l];for(a=0;a<u-1;a++
){c=a-m[a],y=v[a];for(f=a+1;m[f]<=a&&f<u;f++){h=a-m[f],p=g[a]-a,b=v[f],w=b[h]/y[c];if(w){for(l=1;l<=p;l++)b[l+h]-=w*y[l+c];d[f][a-m[f]]=w}}}var y=[],b=[],x=[],T=[],N=[],C=[],o,k,L;o=0,k=0;for(a=0;a<u;a++){c=m[a],h=g[a],L=v[a];for(f=a;f<=h;f++)L[f-c]&&(y[o]=a,b[o]=f,x[o]=L[f-c],o++);L=d[a];for(f=c;f<a;f++)L[f-c]&&(T[k]=a,N[k]=f,C[k]=L[f-c],k++);T[k]=a,N[k]=a,C[k]=1,k++}return{U:[y,b,x],L:[T,N,C]}},t.cLUsolve=function(n,r){var i=n.L,s=n.U,o=t.clone(r),u=i[0],a=i[1],f=i[2],l=s[0],c=s[1],h=s[2],p=l.length,d=u.length,v=o.length,m,g,y;y=0;for(m=0;m<v;m++){while(a[y]<m)o[m]-=f[y]*o[a[y]],y++;y++}y=p-1;for(m=v-1;m>=0;m--){while(c[y]>m)o[m]-=h[y]*o[c[y]],y--;o[m]/=h[y],y--}return o},t.cgrid=function(n,r){typeof n=="number"&&(n=[n,n]);var i=t.rep(n,-1),s,o,u;if(typeof r!="function")switch(r){case"L":r=function(e,t){return e>=n[0]/2||t<n[1]/2};break;default:r=function(e,t){return!0}}u=0;for(s=1;s<n[0]-1;s++)for(o=1;o<n[1]-1;o++)r(s,o)&&(i[s][o]=u,u++);return i},t.cdelsq=function(n){var r=[[-1,0],[0,-1],[0,1],[1,0]],i=t.dim(n),s=i[0],o=i[1],u,a,f,l,c,h=[],p=[],d=[];for(u=1;u<s-1;u++)for(a=1;a<o-1;a++){if(n[u][a]<0)continue;for(f=0;f<4;f++){l=u+r[f][0],c=a+r[f][1];if(n[l][c]<0)continue;h.push(n[u][a]),p.push(n[l][c]),d.push(-1)}h.push(n[u][a]),p.push(n[u][a]),d.push(4)}return[h,p,d]},t.cdotMV=function(n,r){var i,s=n[0],o=n[1],u=n[2],a,f=s.length,l;l=0;for(a=0;a<f;a++)s[a]>l&&(l=s[a]);l++,i=t.rep([l],0);for(a=0;a<f;a++)i[s[a]]+=u[a]*r[o[a]];return i},t.Spline=function(t,n,r,i,s){this.x=t,this.yl=n,this.yr=r,this.kl=i,this.kr=s},t.Spline.prototype._at=function(n,r){var i=this.x,s=this.yl,o=this.yr,u=this.kl,a=this.kr,n,f,l,c,h=t.add,p=t.sub,d=t.mul;f=p(d(u[r],i[r+1]-i[r]),p(o[r+1],s[r])),l=h(d(a[r+1],i[r]-i[r+1]),p(o[r+1],s[r])),c=(n-i[r])/(i[r+1]-i[r]);var v=c*(1-c);return h(h(h(d(1-c,s[r]),d(c,o[r+1])),d(f,v*(1-c))),d(l,v*c))},t.Spline.prototype.at=function(t){if(typeof t=="number"){var n=this.x,r=n.length,i,s,o,u=Math.floor,a,f,l;i=0,s=r-1;while(s-i>1)o=u((i+s)/2),n[o]<=t?i=o:s=o;return this._at(t,i)}var r=t.length,c,h=Array(r);for(c=r-1;c!==-1;--c)h[c]=this.at(t[c]);return h},t.Spline.prototype.diff=function(){var n=this.x,r=this.yl,i=this.yr,s=this.kl,o=this.kr,u=r.length,a,f,l,c=s,h=o,p=Array(u),d=Array(u),v=t.add,m=t.mul,g=t.div,y=t.sub;for(a=u-1;a!==-1;--a)f=n[a+1]-n[a],l=y(i[a+1],r[a]),p[a]=g(v(m(l,6),m(s[a],-4*f),m(o[a+1],-2*f)),f*f),d[a+1]=g(v(m(l,-6),m(s[a],2*f),m(o[a+1],4*f)),f*f);return new t.Spline(n,c,h,p,d)},t.Spline.prototype.roots=function(){function t(e){return e*e}function n(e,t,n,r,i){var s=n*2-(t-e),o=-r*2+(t-e),u=(i+1)*.5,a=u*(1-u);return(1-u)*e+u*t+s*a*(1-u)+o*a*u}var r=[],i=this.x,s=this.yl,o=this.yr,u=this.kl,a=this.kr;typeof s[0]=="number"&&(s=[s],o=[o],u=[u],a=[a]);var f=s.length,l=i.length-1,c,h,p,d,v,m,g,y,b,w,r=Array(f),E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F=Math.sqrt;for(c=0;c!==f;++c){g=s[c],y=o[c],b=u[c],w=a[c],E=[];for(h=0;h!==l;h++){h>0&&y[h]*g[h]<0&&E.push(i[h]),A=i[h+1]-i[h],O=i[h],T=g[h],N=y[h+1],S=b[h]/A,x=w[h+1]/A,L=t(S-x+3*(T-N))+12*x*T,C=x+3*T+2*S-3*N,k=3*(x+S+2*(T-N)),L<=0?(_=C/k,_>i[h]&&_<i[h+1]?M=[i[h],_,i[h+1]]:M=[i[h],i[h+1]]):(_=(C-F(L))/k,D=(C+F(L))/k,M=[i[h]],_>i[h]&&_<i[h+1]&&M.push(_),D>i[h]&&D<i[h+1]&&M.push(D),M.push(i[h+1])),H=M[0],_=this._at(H,h);for(p=0;p<M.length-1;p++){B=M[p+1],D=this._at(B,h);if(_===0){E.push(H),H=B,_=D;continue}if(D===0||_*D>0){H=B,_=D;continue}var I=0;for(;;){j=(_*B-D*H)/(_-D);if(j<=H||j>=B)break;P=this._at(j,h);if(P*D>0)B=j,D=P,I===-1&&(_*=.5),I=-1;else{if(!(P*_>0))break;H=j,_=P,I===1&&(D*=.5),I=1}}E.push(j),H=M[p+1],_=this._at(H,h)}D===0&&E.push(B)}r[c]=E}return typeof this.yl[0]=="number"?r[0]:r},t.spline=function(n,r,i,s){var o=n.length,u=[],a=[],f=[],l,c=t.sub,h=t.mul,p=t.add;for(l=o-2;l>=0;l--)a[l]=n[l+1]-n[l],f[l]=c(r[l+1],r[l]);if(typeof i=="string"||typeof s=="string")i=s="periodic";var d=[[],[],[]];switch(typeof i){case"undefined":u[0]=h(3/(a[0]*a[0]),f[0]),d[0].push(0,0),d[1].push(0,1),d[2].push(2/a[0],1/a[0]);break;case"string":u[0]=p(h(3/(a[o-2]*a[o-2]),f[o-2]),h(3/(a[0]*a[0]),f[0])),d[0].push(0,0,0),d[1].push(o-2,0,1),d[2].push(1/a[o-2],2/a[o-2]+2/a[0],1/a[0]);break;default:u[0]=i,d[0].push(0),d[1].push(0),d[2].push(1)}for(l=1;l<o-1;l++)u[l]=p(h(3/(a[l-1]*a[l-1]),f[l-1]),h(3/(a[l]*a[l]),f[l])),d[0].push(l,l,l),d[1].push(l-1,l,l+1),d[2].push(1/a[l-1],2/a[l-1]+2/a[l],1/a[l]);switch(typeof s){case"undefined":u[o-1]=h(3/(a[o-2]*a[o-2]),f[o-2]),d[0].push(o-1,o-1),d[1].push(o-2,o-1),d[2].push(1/a[o-2],2/a[o-2]);break;case"string":d[1][d[1].length-1]=0;break;default:u[o-1]=s,d[0].push(o-1),d[1].push(o-1),d[2].push(1)}typeof u[0]!="number"?u=t.transpose(u):u=[u];var v=Array(u.length);if(typeof i=="string")for(l=v.length-1;l!==-1;--l)v[l]=t.sLUPsolve(t.sLUP(t.sscatter(d)),u[l]),v[l][o-1]=v[l][0];else for(l=v.length-1;l!==-1;--l)v[l]=t.cLUsolve(t.cLU(d),u[l]);return typeof r[0]=="number"?v=v[0]:v=t.transpose(v),new t.Spline(n,r,r,v,v)},t.fftpow2=function c(e,t){var n=e.length;if(n===1)return;var r=Math.cos,i=Math.sin,s,o,u=Array(n/2),a=Array(n/2),f=Array(n/2),l=Array(n/2);o=n/2;for(s=n-1;s!==-1;--s)--o,f[o]=e[s],l[o]=t[s],--s,u[o]=e[s],a[o]=t[s];c(u,a),c(f,l),o=n/2;var h,p=-6.283185307179586/n,d,v;for(s=n-1;s!==-1;--s)--o,o===-1&&(o=n/2-1),h=p*s,d=r(h),v=i(h),e[s]=u[o]+d*f[o]-v*l[o],t[s]=a[o]+d*l[o]+v*f[o]},t._ifftpow2=function h(e,t){var n=e.length;if(n===1)return;var r=Math.cos,i=Math.sin,s,o,u=Array(n/2),a=Array(n/2),f=Array(n/2),l=Array(n/2);o=n/2;for(s=n-1;s!==-1;--s)--o,f[o]=e[s],l[o]=t[s],--s,u[o]=e[s],a[o]=t[s];h(u,a),h(f,l),o=n/2;var c,p=6.283185307179586/n,d,v;for(s=n-1;s!==-1;--s)--o,o===-1&&(o=n/2-1),c=p*s,d=r(c),v=i(c),e[s]=u[o]+d*f[o]-v*l[o],t[s]=a[o]+d*l[o]+v*f[o]},t.ifftpow2=function(n,r){t._ifftpow2(n,r),t.diveq(n,n.length),t.diveq(r,r.length)},t.convpow2=function(n,r,i,s){t.fftpow2(n,r),t.fftpow2(i,s);var o,u=n.length,a,f,l,c;for(o=u-1;o!==-1;--o)a=n[o],l=r[o],f=i[o],c=s[o],n[o]=a*f-l*c,r[o]=a*c+l*f;t.ifftpow2(n,r)},t.T.prototype.fft=function(){var n=this.x,r=this.y,i=n.length,s=Math.log,o=s(2),u=Math.ceil(s(2*i-1)/o),a=Math.pow(2,u),f=t.rep([a],0),l=t.rep([a],0),c=Math.cos,h=Math.sin,p,d=-3.141592653589793/i,v,m=t.rep([a],0),g=t.rep([a],0),y=Math.floor(i/2);for(p=0;p<i;p++)m[p]=n[p];if(typeof r!="undefined")for(p=0;p<i;p++)g[p]=r[p];f[0]=1;for(p=1;p<=a/2;p++)v=d*p*p,f[p]=c(v),l[p]=h(v),f[a-p]=c(v),l[a-p]=h(v);var b=new t.T(m,g),w=new t.T(f,l);return b=b.mul(w),t.convpow2(b.x,b.y,t.clone(w.x),t.neg(w.y)),b=b.mul(w),b.x.length=i,b.y.length=i,b},t.T.prototype.ifft=function(){var n=this.x,r=this.y,i=n.length,s=Math.log,o=s(2),u=Math.ceil(s(2*i-1)/o),a=Math.pow(2,u),f=t.rep([a],0),l=t.rep([a],0),c=Math.cos,h=Math.sin,p,d=3.141592653589793/i,v,m=t.rep([a],0),g=t.rep([a],0),y=Math.floor(i/2);for(p=0;p<i;p++)m[p]=n[p];if(typeof r!="undefined")for(p=0;p<i;p++)g[p]=r[p];f[0]=1;for(p=1;p<=a/2;p++)v=d*p*p,f[p]=c(v),l[p]=h(v),f[a-p]=c(v),l[a-p]=h(v);var b=new t.T(m,g),w=new t.T(f,l);return b=b.mul(w),t.convpow2(b.x,b.y,t.clone(w.x),t.neg(w.y)),b=b.mul(w),b.x.length=i,b.y.length=i,b.div(i)},t.gradient=function(n,r){var i=r.length,s=n(r),o=Math.max,u,a=t.clone(r),f,l,c=Array(i),h=t.div,p=t.sub,d,v,o=Math.max,m=.001,g=Math.abs,y=Math.min,b,w,E,S=0,x,T,N;for(u=0;u<i;u++){var C=o(1e-6*s,1e-8);for(;;){++S;if(S>20)throw new Error("Numerical gradient fails");a[u]=r[u]+C,f=n(a),a[u]=r[u]-C,l=n(a),a[u]=r[u],c[u]=(f-l)/(2*C),b=r[u]-C,w=r[u],E=r[u]+C,x=(f-s)/C,T=(s-l)/C,N=o(g(c[u]),g(s),g(f),g(l),g(b),g(w),g(E),1e-8),d=y(o(g(x-c[u]),g(T-c[u]),g(x-T))/N,C/N);if(!(d>m))break;C/=16}}return c},t.uncmin=function(n,r,i,s,o,u){var a=t.gradient;typeof i=="undefined"&&(i=1e-8),typeof s=="undefined"&&(s=function(e){return a(n,e)}),typeof o=="undefined"&&(o=1e3),r=t.clone(r);var f=r.length,l=n(r),c,h,p=Math.max,d=t.norm2;i=p(i,t.epsilon);var v,m,g,y=t.identity(f),b=t.dot,w=t.inv,E=t.sub,S=t.add,x=t.tensor,T=t.div,N=t.mul,C=t.all,k=t.NisFinite,L=t.neg,A=0,O,M,_,D,P,H,B,j,F,I,q,R,U="";m=s(r);while(A<o){typeof u=="function"&&u(A,r,l,m,y);if(!C(k(m))){U="Gradient has Infinity or NaN";break}v=L(b(y,m));if(!C(k(v))){U="Search direction has Infinity or NaN";break}I=d(v);if(I<i){U="Newton step smaller than tol";break}F=1,h=b(m,v);while(A<o){if(F*I<i)break;M=N(v,F),_=S(r,M),c=n(_);if(c-l>=.1*F*h){F*=.5,++A;continue}break}if(F*I<i){U="Line search step size smaller than tol";break}if(A===o){U="maxit reached during line search";break}g=s(_),D=E(g,m),B=b(D,M),P=b(y,D),y=E(S(y,N((B+b(D,P))/(B*B),x(M,M))),T(S(x(P,M),x(M,P)),B)),r=_,l=c,m=g,++A}return{solution:r,f:l,gradient:m,invHessian:y,iterations:A,message:U}},t.Dopri=function(t,n,r,i,s,o,u){this.x=t,this.y=n,this.f=r,this.ymid=i,this.iterations=s,this.events=u,this.message=o},t.Dopri.prototype._at=function(n,r){function i(e){return e*e}var s=this,o=s.x,u=s.y,a=s.f,f=s.ymid,l=o.length,c,h,p,d,v,m,n,g=Math.floor,y,b=.5,w=t.add,E=t.mul,S=t.sub,x,T,N;return c=o[r],h=o[r+1],d=u[r],v=u[r+1],y=h-c,p=c+b*y,m=f[r],x=S(a[r],E(d,1/(c-p)+2/(c-h))),T=S(a[r+1],E(v,1/(h-p)+2/(h-c))),N=[i(n-h)*(n-p)/i(c-h)/(c-p),i(n-c)*i(n-h)/i(c-p)/i(h-p),i(n-c)*(n-p)/i(h-c)/(h-p),(n-c)*i(n-h)*(n-p)/i(c-h)/(c-p),(n-h)*i(n-c)*(n-p)/i(c-h)/(h-p)],w(w(w(w(E(d,N[0]),E(m,N[1])),E(v,N[2])),E(x,N[3])),E(T,N[4]))},t.Dopri.prototype.at=function(t){var n,r,i,s=Math.floor;if(typeof t!="number"){var o=t.length,u=Array(o);for(n=o-1;n!==-1;--n)u[n]=this.at(t[n]);return u}var a=this.x;n=0,r=a.length-1;while(r-n>1)i=s(.5*(n+r)),a[i]<=t?n=i:r=i;return this._at(t,n)},t.dopri=function(n,r,i,s,o,u,a){typeof o=="undefined"&&(o=1e-6),typeof u=="undefined"&&(u=1e3);var f=[n],l=[i],c=[s(n,i)],h,p,d,v,m,g,y=[],b=.2,w=[.075,.225],E=[44/45,-56/15,32/9],S=[19372/6561,-25360/2187,64448/6561,-212/729],x=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],T=[35/384,0,500/1113,125/192,-2187/6784,11/84],N=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],C=[.2,.3,.8,8/9,1,1],k=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],L=0,A,O,M=(r-n)/10,_=0,D=t.add,P=t.mul,H,B,j=Math.max,F=Math.min,I=Math.abs,q=t.norminf,R=Math.pow,U=t.any,z=t.lt,W=t.and,X=t.sub,V,$,J,K=new t.Dopri(f,l,c,y,-1,"");typeof a=="function"&&(V=a(n,i));while(n<r&&_<u){++_,n+M>r&&(M=r-n),h=s(n+C[0]*M,D(i,P(b*M,c[L]))),p=s(n+C[1]*M,D(D(i,P(w[0]*M,c[L])),P(w[1]*M,h))),d=s(n+C[2]*M,D(D(D(i,P(E[0]*M,c[L])),P(E[1]*M,h)),P(E[2]*M,p))),v=s(n+C[3]*M,D(D(D(D(i,P(S[0]*M,c[L])),P(S[1]*M,h)),P(S[2]*M,p)),P(S[3]*M,d))),m=s(n+C[4]*M,D(D(D(D(D(i,P(x[0]*M,c[L])),P(x[1]*M,h)),P(x[2]*M,p)),P(x[3]*M,d)),P(x[4]*M,v))),H=D(D(D(D(D(i,P(c[L],M*T[0])),P(p,M*T[2])),P(d,M*T[3])),P(v,M*T[4])),P(m,M*T[5])),g=s(n+M,H),A=D(D(D(D(D(P(c[L],M*k[0]),P(p,M*k[2])),P(d,M*k[3])),P(v,M*k[4])),P(m,M*k[5])),P(g,M*k[6])),typeof A=="number"?B=I(A):B=q(A);if(B>o){M=.2*M*R(o/B,.25);if(n+M===n){K.msg="Step size became too small";break}continue}y[L]=D(D(D(D(D(D(i,P(c[L],M*N[0])),P(p,M*N[2])),P(d,M*N[3])),P(v,M*N[4])),P(m,M*N[5])),P(g,M*N[6])),++L,f[L]=n+M,l[L]=H,c[L]=g;if(typeof a=="function"){var Q,G=n,Y=n+.5*M,Z;$=a(Y,y[L-1]),J=W(z(V,0),z(0,$)),U(J)||(G=Y,Y=n+M,V=$,$=a(Y,H),J=W(z(V,0),z(0,$)));if(U(J)){var et,tt,nt,rt,it=0,st=1,ot=1;for(;;){if(typeof V=="number")Z=(ot*$*G-st*V*Y)/(ot*$-st*V);else{Z=Y;for(O=V.length-1;O!==-1;--O)V[O]<0&&$[O]>0&&(Z=F(Z,(ot*$[O]*G-st*V[O]*Y)/(ot*$[O]-st*V[O])))}if(Z<=G||Z>=Y)break;Q=K._at(Z,L-1),rt=a(Z,Q),nt=W(z(V,0),z(0,rt)),U(nt)?(Y=Z,$=rt,J=nt,ot=1,it===-1?st*=.5:st=1,it=-1):(G=Z,V=rt,st=1,it===1?ot*=.5:ot=1,it=1)}return H=K._at(.5*(n+Z),L-1),K.f[L]=s(Z,Q),K.x[L]=Z,K.y[L]=Q,K.ymid[L-1]=H,K.events=J,K.iterations=_,K}}n+=M,i=H,V=$,M=F(.8*M*R(o/B,.25),4*M)}return K.iterations=_,K},t.seedrandom={pow:Math.pow,random:Math.random},function(e,t,n,r,i,s,o){function u(e){var t,r,i=this,s=e.length,o=0,u=i.i=i.j=i.m=0;i.S=[],i.c=[],s||(e=[s++]);while(o<n)i.S[o]=o++;for(o=0;o<n;o++)t=i.S[o],u=l(u+t+e[o%s]),r=i.S[u],i.S[o]=r,i.S[u]=t;i.g=function(t){var r=i.S,s=l(i.i+1),o=r[s],u=l(i.j+o),a=r[u];r[s]=a,r[u]=o;var f=r[l(o+a)];while(--t)s=l(s+1),o=r[s],u=l(u+o),a=r[u],r[s]=a,r[u]=o,f=f*n+r[l(o+a)];return i.i=s,i.j=u,f},i.g(n)}function a(e,t,n,r,i){n=[],i=typeof e;if(t&&i=="object")for(r in e)if(r.indexOf("S")<5)try{n.push(a(e[r],t-1))}catch(s){}return n.length?n:e+(i!="string"?"\0":"")}function f(e,t,n,r){e+="",n=0;for(r=0;r<e.length;r++)t[l(r)]=l((n^=t[l(r)]*19)+e.charCodeAt(r));e="";for(r in t)e+=String.fromCharCode(t[r]);return e}function l(e){return e&n-1}t.seedrandom=function(c,h){var p=[],d;return c=f(a(h?[c,e]:arguments.length?c:[(new Date).getTime(),e,window],3),p),d=new u(p),f(d.S,e),t.random=function(){var t=d.g(r),u=o,a=0;while(t<i)t=(t+a)*n,u*=n,a=d.g(1);while(t>=s)t/=2,u/=2,a>>>=1;return(t+a)/u},c},o=t.pow(n,r),i=t.pow(2,i),s=i*2,f(t.random(),e)}([],t.seedrandom,256,6,52),function(e){function t(e){if(typeof e!="object")return e;var n=[],r,i=e.length;for(r=0;r<i;r++)n[r+1]=t(e[r]);return n}function n(e){if(typeof e!="object")return e;var t=[],r,i=e.length;for(r=1;r<i;r++)t[r-1]=n(e[r]);return t}function r(e,t,n){var r,i,s,o,u;for(s=1;s<=n;s+=1){e[s][s]=1/e[s][s],u=-e[s][s];for(r=1;r<s;r+=1)e[r][s]=u*e[r][s];o=s+1;if(n<o)break;for(i=o;i<=n;i+=1){u=e[s][i],e[s][i]=0;for(r=1;r<=s;r+=1)e[r][i]=e[r][i]+u*e[r][s]}}}function i(e,t,n,r){var i,s,o,u;for(s=1;s<=n;s+=1){u=0;for(i=1;i<s;i+=1)u+=e[i][s]*r[i];r[s]=(r[s]-u)/e[s][s]}for(o=1;o<=n;o+=1){s=n+1-o,r[s]=r[s]/e[s][s],u=-r[s];for(i=1;i<s;i+=1)r[i]=r[i]+u*e[i][s]}}function s(e,t,n,r){var i,s,o,u,a,f;for(s=1;s<=n;s+=1){r[1]=s,f=0,o=s-1;if(o<1){f=e[s][s]-f;if(f<=0)break;e[s][s]=Math.sqrt(f)}else{for(u=1;u<=o;u+=1){a=e[u][s];for(i=1;i<u;i+=1)a-=e[i][s]*e[i][u];a/=e[u][u],e[u][s]=a,f+=a*a}f=e[s][s]-f;if(f<=0)break;e[s][s]=Math.sqrt(f)}r[1]=0}}function o(e,t,n,o,u,a,f,l,c,h,p,d,v,m,g,y){function V(){m[1]=m[1]+1,E=L;for(b=1;b<=h;b+=1){E+=1,P=-l[b];for(w=1;w<=o;w+=1)P+=f[w][b]*u[w];Math.abs(P)<U&&(P=0);if(b>p)g[E]=P;else{g[E]=-Math.abs(P);if(P>0){for(w=1;w<=o;w+=1)f[w][b]=-f[w][b];l[b]=-l[b]}}}for(b=1;b<=v;b+=1)g[L+d[b]]=0;O=0,D=0;for(b=1;b<=h;b+=1)g[L+b]<D*g[_+b]&&(O=b,D=g[L+b]/g[_+b]);return O===0?999:0}function $(){for(b=1;b<=o;b+=1){P=0;for(w=1;w<=o;w+=1)P+=e[w][b]*f[w][O];g[b]=P}S=N;for(b=1;b<=o;b+=1)g[S+b]=0;for(w=v+1;w<=o;w+=1)for(b=1;b<=o;b+=1)g[S+b]=g[S+b]+e[b][w]*g[w];q=!0;for(b=v;b>=1;b-=1){P=g[b],E=k+b*(b+3)/2,S=E-b;for(w=b+1;w<=v;w+=1)P-=g[E]*g[C+w],E+=w;P/=g[S],g[C+b]=P;if(d[b]<p)break;if(P<0)break;q=!1,T=b}if(!q){H=g[A+T]/g[C+T];for(b=1;b<=v;b+=1){if(d[b]<p)break;if(g[C+b]<0)break;D=g[A+b]/g[C+b],D<H&&(H=D,T=b)}}P=0;for(b=N+1;b<=N+o;b+=1)P+=g[b]*g[b];if(Math.abs(P)<=U){if(q)return y[1]=1,999;for(b=1;b<=v;b+=1)g[A+b]=g[A+b]-H*g[C+b];return g[A+v+1]=g[A+v+1]+H,700}P=0;for(b=1;b<=o;b+=1)P+=g[N+b]*f[b][O];B=-g[L+O]/P,R=!0,q||H<B&&(B=H,R=!1);for(b=1;b<=o;b+=1)u[b]=u[b]+B*g[N+b],Math.abs(u[b])<U&&(u[b]=0);a[1]=a[1]+B*P*(B/2+g[A+v+1]);for(b=1;b<=v;b+=1)g[A+b]=g[A+b]-B*g[C+b];g[A+v+1]=g[A+v+1]+B;if(!R){P=-l[O];for(w=1;w<=o;w+=1)P+=u[w]*f[w][O];if(O>p)g[L+O]=P;else{g[L+O]=-Math.abs(P);if(P>0){for(w=1;w<=o;w+=1)f[w][O]=-f[w][O];l[O]=-l[O]}}return 700}v+=1,d[v]=O,E=k+(v-1)*v/2+1;for(b=1;b<=v-1;b+=1)g[E]=g[b],E+=1;if(v===o)g[E]=g[o];else{for(b=o;b>=v+1;b-=1){if(g[b]===0)break;j=Math.max(Math.abs(g[b-1]),Math.abs(g[b])),F=Math.min(Math.abs(g[b-1]),Math.abs(g[b])),g[b-1]>=0?D=Math.abs(j*Math.sqrt(1+F*F/(j*j))):D=-Math.abs(j*Math.sqrt(1+F*F/(j*j))),j=g[b-1]/D,F=g[b]/D;if(j===1)break;if(j===0){g[b-1]=F*D;for(w=1;w<=o;w+=1)D=e[w][b-1],e[w][b-1]=e[w][b],e[w][b]=D}else{g[b-1]=D,I=F/(1+j);for(w=1;w<=o;w+=1)D=j*e[w][b-1]+F*e[w][b],e[w][b]=I*(e[w][b-1]+D)-e[w][b],e[w][b-1]=D}}g[E]=g[v]}return 0}function J(){E=k+T*(T+1)/2+1,S=E+T;if(g[S]===0)return 798;j=Math.max(Math.abs(g[S-1]),Math.abs(g[S])),F=Math.min(Math.abs(g[S-1]),Math.abs(g[S])),g[S-1]>=0?D=Math.abs(j*Math.sqrt(1+F*F/(j*j))):D=-Math.abs(j*Math.sqrt(1+F*F/(j*j))),j=g[S-1]/D,F=g[S]/D;if(j===1)return 798;if(j===0){for(b=T+1;b<=v;b+=1)D=g[S-1],g[S-1]=g[S],g[S]=D,S+=b;for(b=1;b<=o;b+=1)D=e[b][T],e[b][T]=e[b][T+1],e[b][T+1]=D}else{I=F/(1+j);for(b=T+1;b<=v;b+=1)D=j*g[S-1]+F*g[S],g[S]=I*(g[S-1]+D)-g[S],g[S-1]=D,S+=b;for(b=1;b<=o;b+=1)D=j*e[b][T]+F*e[b][T+1],e[b][T+1]=I*(e[b][T]+D)-e[b][T+1],e[b][T]=D}return 0}function K(){S=E-T;for(b=1;b<=T;b+=1)g[S]=g[E],E+=1,S+=1;return g[A+T]=g[A+T+1],d[T]=d[T+1],T+=1,T<v?797:0}function Q(){return g[A+v]=g[A+v+1],g[A+v+1]=0,d[v]=0,v-=1,m[2]=m[2]+1,0}var b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H,B,j,F,I,q,R,U,z,W,X;M=Math.min(o,h),E=2*o+M*(M+5)/2+2*h+1,U=1e-60;do U+=U,z=1+.1*U,W=1+.2*U;while(z<=1||W<=1);for(b=1;b<=o;b+=1)g[b]=t[b];for(b=o+1;b<=E;b+=1)g[b]=0;for(b=1;b<=h;b+=1)d[b]=0;x=[];if(y[1]===0){s(e,n,o,x);if(x[1]!==0){y[1]=2;return}i(e,n,o,t),r(e,n,o)}else{for(w=1;w<=o;w+=1){u[w]=0;for(b=1;b<=w;b+=1)u[w]=u[w]+e[b][w]*t[b]}for(w=1;w<=o;w+=1){t[w]=0;for(b=w;b<=o;b+=1)t[w]=t[w]+e[w][b]*u[b]}}a[1]=0;for(w=1;w<=o;w+=1){u[w]=t[w],a[1]=a[1]+g[w]*u[w],g[w]=0;for(b=w+1;b<=o;b+=1)e[b][w]=0}a[1]=-a[1]/2,y[1]=0,N=o,C=N+o,A=C+M,k=A+M+1,L=k+M*(M+1)/2,_=L+h;for(b=1;b<=h;b+=1){P=0;for(w=1;w<=o;w+=1)P+=f[w][b]*f[w][b];g[_+b]=Math.sqrt(P)}v=0,m[1]=0,m[2]=0,X=0;for(;;){X=V();if(X===999)return;for(;;){X=$();if(X===0)break;if(X===999)return;if(X===700)if(T===v)Q();else{for(;;){J(),X=K();if(X!==797)break}Q()}}}}function u(e,r,i,s,u,a){e=t(e),r=t(r),i=t(i);var f,l,c,h,p,d=[],v=[],m=[],g=[],y=[],b;u=u||0,a=a?t(a):[undefined,0],s=s?t(s):[],l=e.length-1,c=i[1].length-1;if(!s)for(f=1;f<=c;f+=1)s[f]=0;for(f=1;f<=c;f+=1)v[f]=0;h=0,p=Math.min(l,c);for(f=1;f<=l;f+=1)m[f]=0;d[1]=0;for(f=1;f<=2*l+p*(p+5)/2+2*c+1;f+=1)g[f]=0;for(f=1;f<=2;f+=1)y[f]=0;return o(e,r,l,l,m,d,i,s,l,c,u,v,h,y,g,a),b="",a[1]===1&&(b="constraints are inconsistent, no solution!"),a[1]===2&&(b="matrix D in quadratic function is not positive definite!"),{solution:n(m),value:n(d),unconstrained_solution:n(r),iterations:n(y),iact:n(v),message:b}}e.solveQP=u}(t),t.svd=function(n){function y(e,t){return e=Math.abs(e),t=Math.abs(t),e>t?e*Math.sqrt(1+t*t/e/e):t==0?e:t*Math.sqrt(1+e*e/t/t)}var r,i=t.epsilon,s=1e-64/i,o=50,u=0,a=0,f=0,l=0,c=0,h=t.clone(n),p=h.length,d=h[0].length;if(p<d)throw"Need more rows than columns";var v=new Array(d),m=new Array(d);for(a=0;a<d;a++)v[a]=m[a]=0;var g=t.rep([d,d],0),b=0,w=0,E=0,S=0,x=0,T=0,N=0;for(a=0;a<d;a++){v[a]=w,N=0,c=a+1;for(f=a;f<p;f++)N+=h[f][a]*h[f][a];if(N<=s)w=0;else{b=h[a][a],w=Math.sqrt(N),b>=0&&(w=-w),E=b*w-N,h[a][a]=b-w;for(f=c;f<d;f++){N=0;for(l=a;l<p;l++)N+=h[l][a]*h[l][f];b=N/E;for(l=a;l<p;l++)h[l][f]+=b*h[l][a]}}m[a]=w,N=0;for(f=c;f<d;f++)N+=h[a][f]*h[a][f];if(N<=s)w=0;else{b=h[a][a+1],w=Math.sqrt(N),b>=0&&(w=-w),E=b*w-N,h[a][a+1]=b-w;for(f=c;f<d;f++)v[f]=h[a][f]/E;for(f=c;f<p;f++){N=0;for(l=c;l<d;l++)N+=h[f][l]*h[a][l];for(l=c;l<d;l++)h[f][l]+=N*v[l]}}x=Math.abs(m[a])+Math.abs(v[a]),x>S&&(S=x)}for(a=d-1;a!=-1;a+=-1){if(w!=0){E=w*h[a][a+1];for(f=c;f<d;f++)g[f][a]=h[a][f]/E;for(f=c;f<d;f++){N=0;for(l=c;l<d;l++)N+=h[a][l]*g[l][f];for(l=c;l<d;l++)g[l][f]+=N*g[l][a]}}for(f=c;f<d;f++)g[a][f]=0,g[f][a]=0;g[a][a]=1,w=v[a],c=a}for(a=d-1;a!=-1;a+=-1){c=a+1,w=m[a];for(f=c;f<d;f++)h[a][f]=0;if(w!=0){E=h[a][a]*w;for(f=c;f<d;f++){N=0;for(l=c;l<p;l++)N+=h[l][a]*h[l][f];b=N/E;for(l=a;l<p;l++)h[l][f]+=b*h[l][a]}for(f=a;f<p;f++)h[f][a]=h[f][a]/w}else for(f=a;f<p;f++)h[f][a]=0;h[a][a]+=1}i*=S;for(l=d-1;l!=-1;l+=-1)for(var C=0;C<o;C++){var k=!1;for(c=l;c!=-1;c+=-1){if(Math.abs(v[c])<=i){k=!0;break}if(Math.abs(m[c-1])<=i)break}if(!k){u=0,N=1;var L=c-1;for(a=c;a<l+1;a++){b=N*v[a],v[a]=u*v[a];if(Math.abs(b)<=i)break;w=m[a],E=y(b,w),m[a]=E,u=w/E,N=-b/E;for(f=0;f<p;f++)x=h[f][L],T=h[f][a],h[f][L]=x*u+T*N,h[f][a]=-x*N+T*u}}T=m[l];if(c==l){if(T<0){m[l]=-T;for(f=0;f<d;f++)g[f][l]=-g[f][l]}break}if(C>=o-1)throw"Error: no convergence.";S=m[c],x=m[l-1],w=v[l-1],E=v[l],b=((x-T)*(x+T)+(w-E)*(w+E))/(2*E*x),w=y(b,1),b<0?b=((S-T)*(S+T)+E*(x/(b-w)-E))/S:b=((S-T)*(S+T)+E*(x/(b+w)-E))/S,u=1,N=1;for(a=c+1;a<l+1;a++){w=v[a],x=m[a],E=N*w,w=u*w,T=y(b,E),v[a-1]=T,u=b/T,N=E/T,b=S*u+w*N,w=-S*N+w*u,E=x*N,x*=u;for(f=0;f<d;f++)S=g[f][a-1],T=g[f][a],g[f][a-1]=S*u+T*N,g[f][a]=-S*N+T*u;T=y(b,E),m[a-1]=T,u=b/T,N=E/T,b=u*w+N*x,S=-N*w+u*x;for(f=0;f<p;f++)x=h[f][a-1],T=h[f][a],h[f][a-1]=x*u+T*N,h[f][a]=-x*N+T*u}v[c]=0,v[l]=b,m[l]=S}for(a=0;a<m.length;a++)m[a]<i&&(m[a]=0);for(a=0;a<d;a++)for(f=a-1;f>=0;f--)if(m[f]<m[a]){u=m[f],m[f]=m[a],m[a]=u;for(l=0;l<h.length;l++)r=h[l][a],h[l][a]=h[l][f],h[l][f]=r;for(l=0;l<g.length;l++)r=g[l][a],g[l][a]=g[l][f],g[l][f]=r;a=f}return{U:h,S:m,V:g}},e.GLM=function(n,r){n||(n=e.GLM.families.Gaussian()),r||(r="none");var i={};return i.family=n,i.weights=null,i.fit=function(t,n){return n=e.GLM.utils.atleast_2d(n),n=e.GLM.utils.add_constant(n),i.weights=e.GLM.optimization.IRLS(t,n,i.family),this},i.predict=function(n){n=e.GLM.utils.atleast_2d(n),n=e.GLM.utils.add_constant(n);var r=t.dot(n,i.weights);return i.family.fitted(r)},i};var n=function(e,t){var n=Math.abs(e),r=Math.abs(t),i;return n>r?(i=r/n,n*Math.sqrt(1+i*i)):r>0?(i=n/r,r*Math.sqrt(1+i*i)):0};e.GLM.thinsvd=function(e){var t,r,i,s,o,u,a,f,l=e.length<e[0].length,c=[];if(l)for(t=0;t<e[0].length;t++){c[t]=[];for(r=0;r<e.length;r++)c[t][r]=e[r][t]}else for(t=0;t<e.length;t++){c[t]=[];for(r=0;r<e[0].length;r++)c[t][r]=e[t][r]}e=c;var h=e.length,p=e[0].length,d=Math.min(h,p),v=[],m=[];for(t=0;t<h;t++){m[t]=[];for(r=0;r<p;r++)m[t][r]=0}var g=[];for(t=0;t<p;t++)g[t]=[];var y=[],b=[],w=!0,E=!0,S=Math.min(h-1,p),x=Math.max(0,Math.min(p-2,h));for(i=0;i<Math.max(S,x);i++){if(i<S){v[i]=0;for(t=i;t<h;t++)v[i]=n(v[i],e[t][i]);if(v[i]!==0){e[i][i]<0&&(v[i]=-v[i]);for(t=i;t<h;t++)e[t][i]/=v[i];e[i][i]+=1}v[i]=-v[i]}for(r=i+1;r<p;r++){if(i<S&&v[i]!==0){s=0;for(t=i;t<h;t++)s+=e[t][i]*e[t][r];s=-s/e[i][i];for(t=i;t<h;t++)e[t][r]+=s*e[t][i]}y[r]=e[i][r]}if(w&&i<S)for(t=i;t<h;t++)m[t][i]=e[t][i];if(i<x){y[i]=0;for(t=i+1;t<p;t++)y[i]=n(y[i],y[t]);if(y[i]!==0){y[i+1]<0&&(y[i]=-y[i]);for(t=i+1;t<p;t++)y[t]/=y[i];y[i+1]+=1}y[i]=-y[i];if(i+1<h&&y[i]!==0){for(t=i+1;t<h;t++)b[t]=0;for(r=i+1;r<p;r++)for(t=i+1;t<h;t++)b[t]+=y[r]*e[t][r];for(r=i+1;r<p;r++){s=-y[r]/y[i+1];for(t=i+1;t<h;t++)e[t][r]+=s*b[t]}}if(E)for(t=i+1;t<p;t++)g[t][i]=y[t]}}var T=Math.min(p,h+1);S<p&&(v[S]=e[S][S]),h<T&&(v[T-1]=0),x+1<T&&(y[x]=e[x][T-1]),y[T-1]=0;if(w){for(r=S;r<d;r++){for(t=0;t<h;t++)m[t][r]=0;m[r][r]=1}for(i=S-1;i>=0;i--)if(v[i]!==0){for(r=i+1;r<d;r++){s=0;for(t=i;t<h;t++)s+=m[t][i]*m[t][r];s=-s/m[i][i];for(t=i;t<h;t++)m[t][r]+=s*m[t][i]}for(t=i;t<h;t++)m[t][i]=-m[t][i];m[i][i]=1+m[i][i];for(t=0;t<i-1;t++)m[t][i]=0}else{for(t=0;t<h;t++)m[t][i]=0;m[i][i]=1}}if(E)for(i=p-1;i>=0;i--){if(i<x&&y[i]!==0)for(r=i+1;r<d;r++){s=0;for(t=i+1;t<p;t++)s+=g[t][i]*g[t][r];s=-s/g[i+1][i];for(t=i+1;t<p;t++)g[t][r]+=s*g[t][i]}for(t=0;t<p;t++)g[t][i]=0;g[i][i]=1}var N=T-1,C=0,k=0,L=2.2205e-16,A=1.6034e-291;while(T>0){var O;for(i=T-2;i>=-1;i--){if(i==-1)break;if(Math.abs(y[i])<=A+L*(Math.abs(v[i])+Math.abs(v[i+1]))){y[i]=0;break}}if(i==T-2)O=4;else{var M;for(M=T-1;M>=i;M--){if(M==i)break;s=(M!=T?Math.abs(y[M]):0)+(M!=i+1?Math.abs(y[M-1]):0);if(Math.abs(v[M])<=A+L*s){v[M]=0;break}}M==i?O=3:M==T-1?O=1:(O=2,i=M)}i++;if(O==1){o=y[T-2],y[T-2]=0;for(r=T-2;r>=i;r--){s=n(v[r],o),a=v[r]/s,f=o/s,v[r]=s,r!=i&&(o=-f*y[r-1],y[r-1]=a*y[r-1]);if(E)for(t=0;t<p;t++)s=a*g[t][r]+f*g[t][T-1],g[t][T-1]=-f*g[t][r]+a*g[t][T-1],g[t][r]=s}}else if(O==2){o=y[i-1],y[i-1]=0;for(r=i;r<T;r++){s=n(v[r],o),a=v[r]/s,f=o/s,v[r]=s,o=-f*y[r],y[r]=a*y[r];if(w)for(t=0;t<h;t++)s=a*m[t][r]+f*m[t][i-1],m[t][i-1]=-f*m[t][r]+a*m[t][i-1],m[t][r]=s}}else if(O==3){var _=Math.max(Math.max(Math.max(Math.max(Math.abs(v[T-1]),Math.abs(v[T-2])),Math.abs(y[T-2])),Math.abs(v[i])),Math.abs(y[i])),D=v[T-1]/_,P=v[T-2]/_,H=y[T-2]/_,B=v[i]/_,j=y[i]/_,F=((P+D)*(P-D)+H*H)/2,I=D*H*D*H,q=0;if(F!==0||I!==0)q=Math.sqrt(F*F+I),F<0&&(q=-q),q=I/(F+q);o=(B+D)*(B-D)+q,u=B*j;for(r=i;r<T-1;r++){s=n(o,u),a=o/s,f=u/s,r!=i&&(y[r-1]=s),o=a*v[r]+f*y[r],y[r]=a*y[r]-f*v[r],u=f*v[r+1],v[r+1]=a*v[r+1];if(E)for(t=0;t<p;t++)s=a*g[t][r]+f*g[t][r+1],g[t][r+1]=-f*g[t][r]+a*g[t][r+1],g[t][r]=s;s=n(o,u),a=o/s,f=u/s,v[r]=s,o=a*y[r]+f*v[r+1],v[r+1]=-f*y[r]+a*v[r+1],u=f*y[r+1],y[r+1]=a*y[r+1];if(w&&r<h-1)for(t=0;t<h;t++)s=a*m[t][r]+f*m[t][r+1],m[t][r+1]=-f*m[t][r]+a*m[t][r+1],m[t][r]=s}y[T-2]=o,C+=1}else if(O==4){if(v[i]<=0){v[i]=v[i]<0?-v[i]:0;if(E)for(t=0;t<=N;t++)g[t][i]=-g[t][i]}while(i<N){if(v[i]>=v[i+1])break;s=v[i],v[i]=v[i+1],v[i+1]=s;if(E&&i<p-1)for(t=0;t<p;t++)s=g[t][i+1],g[t][i+1]=g[t][i],g[t][i]=s;if(w&&i<h-1)for(t=0;t<h;t++)s=m[t][i+1],m[t][i+1]=m[t][i],m[t][i]=s;i++}k+=C,C=0,T--}}return l?[g,v,m,k]:[m,v,g,k]},e.GLM.version="0.0.1",e.GLM.testing=e.GLM.testing||{},e.GLM.testing.fuzzyArrayEqual=function(e,t,n){n||(n=1e-4);if(e.length!=t.length)return!1;for(var r=0;r<e.length;r++)if(Math.abs(e[r]-t[r])>n)return!1;return!0},e.GLM.utils=e.GLM.utils||{},e.GLM.utils.mean=function(e){var t=0;for(var n=0;n<e.length;n++)t+=e[n];return t/e.length},e.GLM.utils.checkConvergence=function(e,t,n,r){var i=1e-8;return t!=null&&Math.abs(e-t)<i||n>r},e.GLM.utils.softThreshold=function(e,t){var n=Math.abs(e);return t<n?e>0?e-t:e+t:0},e.GLM.utils.makeArray=function(e,t){var n=[];for(var r=0;r<e;r++)n.push(t);return n},e.GLM.utils.zeros=function(t){return e.GLM.utils.makeArray(t,0)},e.GLM.utils.map=function(e,t){var n=[];for(var r=0;r<e.length;r++)n.push(t(e[r],r));return n},e.GLM.utils.isArray=function(e){return e.constructor==Array},e.GLM.utils.atleast_2d=function(t){return e.GLM.utils.isArray(t[0])?t:[t]},e.GLM.utils.add_constant=function(t){return e.GLM.utils.map(t,function(e){e.push(1)}),t},e.GLM.utils.dot=function(t,n){var r,i=e.GLM.utils.isArray(t[0]),s=e.GLM.utils.isArray(n[0]);console.log(" DOT "),console.log("a ",t),console.log("b ",n);if(i&s){r=[];for(var o=0;o<t.length;o++){r[r.length]=e.GLM.utils.zeros(n[0].length);for(var u=0;u<n[0].length;u++)for(var a=0;a<t.length;a++)r[o][u]+=t[o][a]*n[a][u]}return r}if(i|s)return e.GLM.utils.dot(e.GLM.utils.atleast_2d(t),e.GLM.utils.atleast_2d(n));r=0;for(var o=0;o<t.length;o++)r+=t[o]*n[o];return r},e.GLM.utils.transpose=function(t){var n=[];t=e.GLM.utils.atleast_2d(t);for(var r=0;r<t[0].length;r++)n[r]=e.GLM.utils.zeros(t.length);for(var r=0;r<t.length;r++)for(var i=0;i<t[0].length;i++)n[i][r]=t[r][i];return n},e.GLM.families=e.GLM.families||{},e.GLM.families.Binomial=function(t){return t||(t=e.GLM.links.Logit()),model={},model.initialMu=function(e){var t=[];for(var n=0;n<e.length;n++)t.push((e[n]+.5)/2);return t},model.deviance=function(e,t){var n=0;for(var r=0;r<t.length;r++){var i=e[r]==1?1:0;n+=i*Math.log(t[r]+1e-200)+(1-i)*Math.log(1-t[r]+1e-200)}return 2*n},model.link=t,model.predict=function(e){return model.link(e)},model.weights=function(t){function n(e){return e<1e-10?1e-10:e>1-1e-10?1-1e-10:e}var r=e.GLM.utils.map(t,function(e){return n(e)*(1-n(e))});return e.GLM.utils.map(model.link.derivative(t),function(e,t){return 1/(Math.pow(e,2)*r[t])})},model.fitted=function(e){return model.link.inverse(e)},model},e.GLM.families.Gaussian=function(t){t||(t=e.GLM.links.Identity());var n={};return n.deviance=function(e,t){var n=0;for(var r=0;r<e.length;r++)n+=Math.pow(e[r]-t[r],2);return n},n.initialMu=function(t){var n=e.GLM.utils.mean(t),r=[];for(var i=0;i<t.length;i++)r.push((t[i]+n)/2);return r},n.link=t,n.predict=function(e){return n.link(e)},n.weights=function(t){var r=e.GLM.utils.makeArray(t.length,1);return e.GLM.utils.map(n.link.derivative(t),function(e,t){return 1/(Math.pow(e,2)/r[t])})},n.fitted=function(e){return n.link.inverse(e)},n},e.GLM.links=e.GLM.links||{},e.GLM.links.Logit=function(){var t=function(t){return e.GLM.utils.map(t,function(e){return Math.log(e/(1-e))})};return t.inverse=function(t){return e.GLM.utils.map(t,function(e){var t=Math.exp(e);return t/(1+t)})},t.derivative=function(t){return e.GLM.utils.map(t,function(e){return 1/(e*(1-e))})},t},e.GLM.links.Power=function(t){var n=function(n){return e.GLM.utils.map(n,function(e){return Math.pow(e,t)})};return n.inverse=function(n){return e.GLM.utils.map(n,function(e){return Math.pow(e,1/t)})},n.derivative=function(n){return e.GLM.utils.map(n,function(e){return t*Math.pow(e,t-1)})},n},e.GLM.links.Identity=function(){return e.GLM.links.Power(1)},e.GLM.links.Log=function(){var t=function(t){return e.GLM.utils.map(t,Math.log)};return t.inverse=function(t){return e.GLM.utils.map(t,Math.exp)},t.derivative=function(t){return e.GLM.utils.map(t,function(e){return 1/e})},t},e.GLM.links.NegativeBinomial=function(t){var n=function(n){return e.GLM.utils.map(n,function(e){return Math.log(e/(e+1/t))})};return n.inverse=function(n){return e.GLM.utils.map(n,function(e){return Math.exp(e)/(t*(1-Math.exp(e)))})},n.derivative=function(n){return e.GLM.utils.map(n,function(e){return 1/(e+t*Math.pow(e,2))})},n},e.GLM.optimization=e.optimization||{},e.GLM.optimization.IRLS=function(n,r,i){var s=!1,o=0,u=5,a=i.initialMu(n),f=i.predict(a),l=i.deviance(n,a),c=null,h=e.GLM.utils.makeArray(n.length,1);while(!s){var p=t.mul(h,i.weights(a));oldDeviance=l;var d=0,v=i.link.derivative(a),m=e.GLM.utils.map(f,function(e,t){return e+v[t]*(n[t]-a[t])});c=e.GLM.optimization.linearSolve(m,r,p),f=t.dot(r,c),a=i.fitted(f),l=i.deviance(n,a),s=e.GLM.utils.checkConvergence(l,oldDeviance,o,u),o+=1}return c},e.GLM.optimization.linearSolve=function(n,r,i){function s(t,n){return t[0].hasOwnProperty("length")?e.GLM.utils.map(n,function(n,r){return e.GLM.utils.map(t[r],function(e){return Math.sqrt(n)*e})}):e.GLM.utils.map(n,function(e,n){return Math.sqrt(e)*t[n]})}function o(e){var n=t.identity(e.length);for(var r=0;r<e.length;r++)n[r][r]/=e[r];return n}n=s(n,i),r=s(r,i);var u=e.GLM.thinsvd(t.dot(t.transpose(r),r)),a=u[0],f=o(u[1]),l=u[2],c=e.GLM.utils.dot(a,e.GLM.utils.dot(f,t.inv(l))),h=t.dot(t.dot(c,e.GLM.utils.transpose(r)),n);return h}})(this);