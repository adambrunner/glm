(function(a){a.testing=a.testing||{},a.testing.fuzzyArrayEqual=function(a,b,c){c||(c=1e-4);if(a.length!=b.length)return!1;for(var d=0;d<a.length;d++)if(Math.abs(a[d]-b[d])>c)return!1;return!0};var b=typeof a=="undefined"?function(){}:a;typeof global!="undefined"&&(global.numeric=b),b.version="1.0.2",b.bench=function(b,c){var d,e,f,g;typeof c=="undefined"&&(c=15),f=1,d=new Date;for(;;){f*=2;for(g=f;g>3;g-=4)b(),b(),b(),b();while(g>0)b(),g--;e=new Date;if(e-d>c)break}for(g=f;g>3;g-=4)b(),b(),b(),b();while(g>0)b(),g--;return e=new Date,1e3*(3*f-1)/(e-d)},b.Function=Function,b.precision=4,b.largeArray=50,b.prettyPrint=function(c){function d(a){if(a===0)return"0";if(isNaN(a))return"NaN";if(a<0)return"-"+d(-a);if(isFinite(a)){var c=Math.floor(Math.log(a)/Math.log(10)),e=a/Math.pow(10,c),f=e.toPrecision(b.precision);return parseFloat(f)===10&&(c++,e=1,f=e.toPrecision(b.precision)),parseFloat(f).toString()+"e"+c.toString()}return"Infinity"}function f(a){var c;if(typeof a=="undefined")return e.push(Array(b.precision+8).join(" ")),!1;if(typeof a=="string")return e.push('"'+a+'"'),!1;if(typeof a=="boolean")return e.push(a.toString()),!1;if(typeof a=="number"){var g=d(a),h=a.toPrecision(b.precision),i=parseFloat(a.toString()).toString(),j=[g,h,i,parseFloat(h).toString(),parseFloat(i).toString()];for(c=1;c<j.length;c++)j[c].length<g.length&&(g=j[c]);return e.push(Array(b.precision+8-g.length).join(" ")+g),!1}if(a===null)return e.push("null"),!1;if(typeof a=="function"){e.push(a.toString());var k=!1;for(c in a)a.hasOwnProperty(c)&&(k?e.push(",\n"):e.push("\n{"),k=!0,e.push(c),e.push(": \n"),f(a[c]));return k&&e.push("}\n"),!0}if(a instanceof Array){if(a.length>b.largeArray)return e.push("...Large Array..."),!0;var k=!1;e.push("[");for(c=0;c<a.length;c++)c>0&&(e.push(","),k&&e.push("\n ")),k=f(a[c]);return e.push("]"),!0}e.push("{");var k=!1;for(c in a)a.hasOwnProperty(c)&&(k&&e.push(",\n"),k=!0,e.push(c),e.push(": \n"),f(a[c]));return e.push("}"),!0}var e=[];return f(c),e.join("")},b.parseDate=function(b){function c(a){if(typeof a=="string")return Date.parse(a.replace(/-/g,"/"));if(a instanceof Array){var b=[],d;for(d=0;d<a.length;d++)b[d]=c(a[d]);return b}throw new Error("parseDate: parameter must be arrays of strings")}return c(b)},b.parseFloat=function(b){function c(a){if(typeof a=="string")return parseFloat(a);if(a instanceof Array){var b=[],d;for(d=0;d<a.length;d++)b[d]=c(a[d]);return b}throw new Error("parseFloat: parameter must be arrays of strings")}return c(b)},b.parseCSV=function(b){var c=b.split("\n"),d,e,f=[],g=/(([^'",]*)|('[^']*')|("[^"]*")),/g,h=/^\s*(([+-]?[0-9]+(\.[0-9]*)?(e[+-]?[0-9]+)?)|([+-]?[0-9]*(\.[0-9]+)?(e[+-]?[0-9]+)?))\s*$/,i=function(a){return a.substr(0,a.length-1)},j=0;for(e=0;e<c.length;e++){var k=(c[e]+",").match(g),l;if(k.length>0){f[j]=[];for(d=0;d<k.length;d++)l=i(k[d]),h.test(l)?f[j][d]=parseFloat(l):f[j][d]=l;j++}}return f},b.toCSV=function(c){var d=b.dim(c),e,f,g,h,i,j;g=d[0],h=d[1],j=[];for(e=0;e<g;e++){i=[];for(f=0;f<g;f++)i[f]=c[e][f].toString();j[e]=i.join(", ")}return j.join("\n")+"\n"},b.getURL=function(b){var c=new XMLHttpRequest;return c.open("GET",b,!1),c.send(),c},b.imageURL=function(b){function c(a){var b=a.length,c,d,e,f,g,h,i,j,k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l="";for(c=0;c<b;c+=3)d=a[c],e=a[c+1],f=a[c+2],g=d>>2,h=((d&3)<<4)+(e>>4),i=((e&15)<<2)+(f>>6),j=f&63,c+1>=b?i=j=64:c+2>=b&&(j=64),l+=k.charAt(g)+k.charAt(h)+k.charAt(i)+k.charAt(j);return l}function d(a,b,c){typeof b=="undefined"&&(b=0),typeof c=="undefined"&&(c=a.length);var d=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117],e=-1,f=0,g=a.length,h;for(h=b;h<c;h++)f=(e^a[h])&255,e=e>>>8^d[f];return e^-1}var e=b[0].length,f=b[0][0].length,g,h,i,j,k,l,m,n,o,p,q,r=[137,80,78,71,13,10,26,10,0,0,0,13,73,72,68,82,f>>24&255,f>>16&255,f>>8&255,f&255,e>>24&255,e>>16&255,e>>8&255,e&255,8,2,0,0,0,-1,-2,-3,-4,-5,-6,-7,-8,73,68,65,84,8,29];q=d(r,12,29),r[29]=q>>24&255,r[30]=q>>16&255,r[31]=q>>8&255,r[32]=q&255,g=1,h=0;for(n=0;n<e;n++){n<e-1?r.push(0):r.push(1),l=3*f+1+(n===0)&255,m=3*f+1+(n===0)>>8&255,r.push(l),r.push(m),r.push(~l&255),r.push(~m&255),n===0&&r.push(0);for(o=0;o<f;o++)for(j=0;j<3;j++)l=b[j][n][o],l>255?l=255:l<0?l=0:l=Math.round(l),g=(g+l)%65521,h=(h+g)%65521,r.push(l);r.push(0)}return p=(h<<16)+g,r.push(p>>24&255),r.push(p>>16&255),r.push(p>>8&255),r.push(p&255),k=r.length-41,r[33]=k>>24&255,r[34]=k>>16&255,r[35]=k>>8&255,r[36]=k&255,q=d(r,37),r.push(q>>24&255),r.push(q>>16&255),r.push(q>>8&255),r.push(q&255),r.push(0),r.push(0),r.push(0),r.push(0),r.push(73),r.push(69),r.push(78),r.push(68),r.push(174),r.push(66),r.push(96),r.push(130),"data:image/png;base64,"+c(r)},b._dim=function(b){var c=[];while(typeof b=="object")c.push(b.length),b=b[0];return c},b.dim=function(c){var d,e;if(typeof c=="object")return d=c[0],typeof d=="object"?(e=d[0],typeof e=="object"?b._dim(c):[c.length,d.length]):[c.length];return[]},b.mapreduce=function(c,d){return b.Function("x","accum","_s","_k",'if(typeof accum === "undefined") accum = '+d+";\n"+'if(typeof _s === "undefined") _s = numeric.dim(x);\n'+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i,xi;\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) {\n"+"        accum = arguments.callee(x[i],accum,_s,_k+1);\n"+"    }"+"    return accum;\n"+"}\n"+"for(i=_n-1;i>=1;i-=2) { \n"+"    xi = x[i];\n"+"    "+c+";\n"+"    xi = x[i-1];\n"+"    "+c+";\n"+"}\n"+"if(i === 0) {\n"+"    xi = x[i];\n"+"    "+c+"\n"+"}\n"+"return accum;")},b.same=function c(a,b){var d,e;if(a instanceof Array&&b instanceof Array){e=a.length;if(e!==b.length)return!1;for(d=0;d<e;d++){if(a[d]===b[d])continue;if(typeof a[d]!="object")return!1;if(!c(a[d],b[d]))return!1}return!0}return!1},b.rep=function(c,d,e){typeof e=="undefined"&&(e=0);var f=c[e],g=Array(f),h;if(e===c.length-1){for(h=f-2;h>=0;h-=2)g[h+1]=d,g[h]=d;return h===-1&&(g[0]=d),g}for(h=f-1;h>=0;h--)g[h]=b.rep(c,d,e+1);return g},b.dotMMbig=function(c,d){var e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x=b.dotVV,y=Math.min;h=c.length,i=d.length,j=d[0].length,k=Array(h),n=b.transpose(d);for(o=0;o<h;o+=4){q=y(o+4,h);for(e=o;e<q;e++)k[e]=Array(j);for(p=0;p<j;p+=4){r=y(p+4,j);for(e=o;e<q;e++){m=c[e],l=k[e];for(g=p;g<r;g++)l[g]=x(m,n[g])}}}return k},b.dotMMsmall=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q;g=b.length,h=c.length,i=c[0].length,j=Array(g);for(d=g-1;d>=0;d--){k=Array(i),l=b[d];for(f=i-1;f>=0;f--){m=l[h-1]*c[h-1][f];for(e=h-2;e>=1;e-=2)n=e-1,m+=l[e]*c[e][f]+l[n]*c[n][f];e===0&&(m+=l[0]*c[0][f]),k[f]=m}j[d]=k}return j},b.dotMV=function(c,d){var e=c.length,f=d.length,g,h=Array(e),i=b.dotVV;for(g=e-1;g>=0;g--)h[g]=i(c[g],d);return h},b.dotVM=function(b,c){var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v;g=b.length,h=c[0].length,j=Array(h);for(f=h-1;f>=0;f--){m=b[g-1]*c[g-1][f];for(e=g-2;e>=1;e-=2)n=e-1,m+=b[e]*c[e][f]+b[n]*c[n][f];e===0&&(m+=b[0]*c[0][f]),j[f]=m}return j},b.dotVV=function(b,c){var d,e=b.length,f,g=b[e-1]*c[e-1];for(d=e-2;d>=1;d-=2)f=d-1,g+=b[d]*c[d]+b[f]*c[f];return d===0&&(g+=b[0]*c[0]),g},b.dot=function(c,d){var e=b.dim;switch(e(c).length*1e3+e(d).length){case 2002:return d.length<40?b.dotMMsmall(c,d):b.dotMMbig(c,d);case 2001:return b.dotMV(c,d);case 1002:return b.dotVM(c,d);case 1001:return b.dotVV(c,d);case 1e3:return b.mulVS(c,d);case 1:return b.mulSV(c,d);case 0:return c*d;default:throw new Error("numeric.dot only works on vectors and matrices")}},b.diag=function(b){var c,d,e,f=b.length,g=Array(f),h;for(c=f-1;c>=0;c--){h=Array(f),d=c+2;for(e=f-1;e>=d;e-=2)h[e]=0,h[e-1]=0;e>c&&(h[e]=0),h[c]=b[c];for(e=c-1;e>=1;e-=2)h[e]=0,h[e-1]=0;e===0&&(h[0]=0),g[c]=h}return g},b.getDiag=function(a){var b=Math.min(a.length,a[0].length),c,d=Array(b);for(c=b-1;c>=1;--c)d[c]=a[c][c],--c,d[c]=a[c][c];return c===0&&(d[0]=a[0][0]),d},b.identity=function(c){return b.diag(b.rep([c],1))},b.pointwise=function(c,d,e){typeof e=="undefined"&&(e="");var f=[],g,h=/\[i\]$/,i,j="";for(g=0;g<c.length;g++)h.test(c[g])?(i=c[g].substring(0,c[g].length-3),j=i):i=c[g],f.push(i);return f[c.length]="_s",f[c.length+1]="_k",f[c.length+2]='if(typeof _s === "undefined") _s = numeric.dim('+j+");\n"+'if(typeof _k === "undefined") _k = 0;\n'+"var _n = _s[_k];\n"+"var i, ret = Array(_n);\n"+"if(_k < _s.length-1) {\n"+"    for(i=_n-1;i>=0;i--) ret[i] = arguments.callee("+c.join(",")+",_s,_k+1);\n"+"    return ret;\n"+"}\n"+e+"\n"+"for(i=_n-1;i>=3;--i) { \n"+"    "+d+"\n"+"    --i;\n"+"    "+d+"\n"+"    --i;\n"+"    "+d+"\n"+"    --i;\n"+"    "+d+"\n"+"}\n"+"while(i>=0) {\n"+"    "+d+"\n"+"    --i;\n"+"}\n"+"return ret;",b.Function.apply(null,f)},b._biforeach=function d(a,b,c,e,f){if(e===c.length-1){f(a,b);return}var g,h=c[e];for(g=h-1;g>=0;g--)d(a[g],b[g],c,e+1,f)},b.anyV=b.mapreduce("if(xi) return true;","false"),b.allV=b.mapreduce("if(!xi) return false;","true"),b.any=function(a){return typeof a.length=="undefined"?a:b.anyV(a)},b.all=function(a){return typeof a.length=="undefined"?a:b.allV(a)},b.ops2={add:"+",sub:"-",mul:"*",div:"/",mod:"%",and:"&&",or:"||",eq:"===",neq:"!==",lt:"<",gt:">",leq:"<=",geq:">=",band:"&",bor:"|",bxor:"^",lshift:"<<",rshift:">>",rrshift:">>>"},b.opseq={addeq:"+=",subeq:"-=",muleq:"*=",diveq:"/=",modeq:"%=",lshifteq:"<<=",rshifteq:">>=",rrshifteq:">>>=",andeq:"&=",oreq:"|=",xoreq:"^="},b.mathfuns=["abs","acos","asin","atan","ceil","cos","exp","floor","log","round","sin","sqrt","tan"],b.ops1={neg:"-",not:"!",bnot:"~"},function(){var a,c;for(a in b.ops2)b.ops2.hasOwnProperty(a)&&(c=b.ops2[a],b[a+"VV"]=b.pointwise(["x[i]","y[i]"],"ret[i] = x[i] "+c+" y[i];"),b[a+"SV"]=b.pointwise(["x","y[i]"],"ret[i] = x "+c+" y[i];"),b[a+"VS"]=b.pointwise(["x[i]","y"],"ret[i] = x[i] "+c+" y;"),b[a]=b.Function("var n = arguments.length, i, x = arguments[0], y;\nvar VV = numeric."+a+"VV, VS = numeric."+a+"VS, SV = numeric."+a+"SV;\n"+"for(i=1;i!==n;++i) { \n"+"  y = arguments[i];"+'  if(typeof x === "object") {\n'+'      if(typeof y === "object") x = VV(x,y);\n'+"      else x = VS(x,y);\n"+'  } else if(typeof y === "object") x = SV(x,y);\n'+"  else x = x "+c+" y;\n"+"}\nreturn x;\n"),b[c]=b[a]);for(a in b.ops1)b.ops1.hasOwnProperty(a)&&(c=b.ops1[a],b[a+"V"]=b.pointwise(["x[i]"],"ret[i] = "+c+"x[i];"),b[a]=b.Function("x",'if(typeof x === "object") return numeric.'+a+"V(x);\nreturn "+c+"(x);"));for(a=0;a<b.mathfuns.length;a++)c=b.mathfuns[a],b[c+"V"]=b.pointwise(["x[i]"],"ret[i] = fun(x[i]);","var fun = Math."+c+";"),b[c]=b.Function("x",'if(typeof x === "object") return numeric.'+c+"V(x);\nreturn Math."+c+"(x);");b.isNaNV=b.pointwise(["x[i]"],"ret[i] = isNaN(x[i]);"),b.isNaN=function d(a){return typeof a=="object"?b.isNaNV(a):d(a)},b.isFiniteV=b.pointwise(["x[i]"],"ret[i] = isFinite(x[i]);"),b.isFinite=function(c){return typeof c=="object"?b.isFiniteV(c):isFinite(c)};for(a in b.opseq)b.opseq.hasOwnProperty(a)&&(b[a+"S"]=b.Function("x","y","var n = x.length, i;\nfor(i=n-1;i>=0;i--) x[i] "+b.opseq[a]+" y;"),b[a+"V"]=b.Function("x","y","var n = x.length, i;\nfor(i=n-1;i>=0;i--) x[i] "+b.opseq[a]+" y[i];"),b[a]=b.Function("x","y",'var s = numeric.dim(x);\nif(typeof y === "number") { numeric._biforeach(x,y,s,0,numeric.'+a+"S); return x; }\n"+"numeric._biforeach(x,y,s,0,numeric."+a+"V);\n"+"return x;"),b[b.opseq[a]]=b[a])}(),b.atan2VV=b.pointwise(["x[i]","y[i]"],"ret[i] = atan2(x[i],y[i]);","var atan2 = Math.atan2;"),b.atan2VS=b.pointwise(["x[i]","y"],"ret[i] = atan2(x[i],y);","var atan2 = Math.atan2;"),b.atan2SV=b.pointwise(["x","y[i]"],"ret[i] = atan2(x,y[i]);","var atan2 = Math.atan2;"),b.atan2=function(c,d){return typeof c=="object"?typeof d=="object"?b.atan2VV(c,d):b.atan2VS(c,d):typeof d=="object"?b.atan2SV(c,d):Math.atan2(c,d)},b.powVV=b.pointwise(["x[i]","y[i]"],"ret[i] = pow(x[i],y[i]);","var pow = Math.pow;"),b.powVS=b.pointwise(["x[i]","y"],"ret[i] = pow(x[i],y);","var pow = Math.pow;"),b.powSV=b.pointwise(["x","y[i]"],"ret[i] = pow(x,y[i]);","var pow = Math.pow;"),b.pow=function(c,d){return typeof c=="object"?typeof d=="object"?b.powVV(c,d):b.powVS(c,d):typeof d=="object"?b.powSV(c,d):Math.pow(c,d)},b.clone=b.pointwise(["x[i]"],"ret[i] = x[i];"),b.inv=function(c){var d=b.dim(c),e=Math.abs;if(d.length!==2||d[0]!==d[1])throw new Error("numeric: inv() only works on square matrices");var f=d[0],g=b.identity(f),h,i,j,k=b.clone(c),l,m,n,o,p,q,r,s,t,u,v=b.linspace(0,f-1),w=b.rep([f],0);for(i=0;i<f-1;i++){j=i;for(h=i+1;h<f;h++)e(k[h][i])>e(k[j][i])&&(j=h);j!==i&&(q=k[j],k[j]=k[i],k[i]=q,q=g[j],g[j]=g[i],g[i]=q,q=v[j],v[j]=v[i],v[i]=q),l=k[i],n=g[i];for(h=i+1;h<f;h++){m=k[h],o=g[h],p=m[i]/l[i];if(p===0)continue;for(j=i+1;j<f-1;j+=2)s=j+1,m[j]-=l[j]*p,m[s]-=l[s]*p;j<f&&(m[j]-=l[j]*p);for(j=i;j>=1;j-=2)t=v[j-1],u=v[j],o[t]-=n[t]*p,o[u]-=n[u]*p;j>=0&&(o[v[j]]-=n[v[j]]*p)}}for(i=f-1;i>0;i--){l=k[i],n=g[i];for(h=0;h<i;h++){o=g[h],p=k[h][i]/l[i];if(p===0)continue;for(j=0;j<f-1;j+=2)s=j+1,o[j]-=n[j]*p,o[s]-=n[s]*p;j!==f&&(o[j]-=n[j]*p)}}for(h=0;h<f;h++){p=k[h][h];if(p===1)continue;o=g[h];for(i=0;i<f;i++)o[i]/=p}return g},b.det=function(c){var d=b.dim(c);if(d.length!==2||d[0]!==d[1])throw new Error("numeric: det() only works on square matrices");var e=d[0],f=1,g,h,i,j=b.clone(c),k,l,m,n,o,p,q;for(h=0;h<e-1;h++){i=h;for(g=h+1;g<e;g++)Math.abs(j[g][h])>Math.abs(j[i][h])&&(i=g);i!==h&&(n=j[i],j[i]=j[h],j[h]=n,f*=-1),k=j[h];for(g=h+1;g<e;g++){l=j[g],m=l[h]/k[h];for(i=h+1;i<e-1;i+=2)o=i+1,l[i]-=k[i]*m,l[o]-=k[o]*m;i!==e&&(l[i]-=k[i]*m)}if(k[h]===0)return 0;f*=k[h]}return f*j[h][h]},b.transpose=function(b){var c,d,e=b.length,f=b[0].length,g=Array(f),h,i,j;for(d=0;d<f;d++)g[d]=Array(e);for(c=e-1;c>=1;c-=2){i=b[c],h=b[c-1];for(d=f-1;d>=1;--d)j=g[d],j[c]=i[d],j[c-1]=h[d],--d,j=g[d],j[c]=i[d],j[c-1]=h[d];d===0&&(j=g[0],j[c]=i[0],j[c-1]=h[0])}if(c===0){h=b[0];for(d=f-1;d>=1;--d)g[d][0]=h[d],--d,g[d][0]=h[d];d===0&&(g[0][0]=h[0])}return g},b.negtranspose=function(b){var c,d,e=b.length,f=b[0].length,g=Array(f),h,i,j;for(d=0;d<f;d++)g[d]=Array(e);for(c=e-1;c>=1;c-=2){i=b[c],h=b[c-1];for(d=f-1;d>=1;--d)j=g[d],j[c]=-i[d],j[c-1]=-h[d],--d,j=g[d],j[c]=-i[d],j[c-1]=-h[d];d===0&&(j=g[0],j[c]=-i[0],j[c-1]=-h[0])}if(c===0){h=b[0];for(d=f-1;d>=1;--d)g[d][0]=-h[d],--d,g[d][0]=-h[d];d===0&&(g[0][0]=-h[0])}return g},b._random=function e(a,b){var c,d=a[b],f=Array(d),g;if(b===a.length-1){g=Math.random;for(c=d-1;c>=1;c-=2)f[c]=g(),f[c-1]=g();return c===0&&(f[0]=g()),f}for(c=d-1;c>=0;c--)f[c]=e(a,b+1);return f},b.random=function(c){return b._random(c,0)},b.norm2Squared=function(b){},b.norm2Squared=b.mapreduce("accum += xi*xi;","0"),b.norm2=function(c){return Math.sqrt(b.norm2Squared(c))},b.norminf=b.mapreduce("accum = max(abs(xi),accum);","0; var max = Math.max, abs = Math.abs;"),b.sum=b.mapreduce("accum += xi;","0"),b.linspace=function(b,c,d){typeof d=="undefined"&&(d=Math.round(c-b)+1);var e,f=Array(d);d--;for(e=d;e>=0;e--)f[e]=(e*c+(d-e)*b)/d;return f},b.getBlock=function(c,d,e){function g(a,b){var c,h=d[b],i=e[b]-h,j=Array(i);if(b===f.length-1){for(c=i;c>=0;c--)j[c]=a[c+h];return j}for(c=i;c>=0;c--)j[c]=g(a[c+h],b+1);return j}var f=b.dim(c);return g(c,0)},b.setBlock=function(c,d,e,f){function h(a,b,c){var f,i=d[c],j=e[c]-i;if(c===g.length-1)for(f=j;f>=0;f--)a[f+i]=b[f];for(f=j;f>=0;f--)h(a[f+i],b[f],c+1)}var g=b.dim(c);return h(c,f,0),c},b.tensor=function(c,d){if(typeof c=="number"||typeof d=="number")return b.mul(c,d);var e=b.dim(c),f=b.dim(d);if(e.length!==1||f.length!==1)throw new Error("numeric: tensor product is only defined for vectors");var g=e[0],h=f[0],i=Array(g),j,k,l,m;for(k=g-1;k>=0;k--){j=Array(h),m=c[k];for(l=h-1;l>=3;--l)j[l]=m*d[l],--l,j[l]=m*d[l],--l,j[l]=m*d[l],--l,j[l]=m*d[l];while(l>=0)j[l]=m*d[l],--l;i[k]=j}return i},b.T=function(b,c){this.x=b,this.y=c},b.t=function(c,d){return new b.T(c,d)},b.Tbinop=function(c,d,e,f,g){var h=b.indexOf;if(typeof g!="string"){var i;g="";for(i in b)b.hasOwnProperty(i)&&(c.indexOf(i)>=0||d.indexOf(i)>=0||e.indexOf(i)>=0||f.indexOf(i)>=0)&&i.length>1&&(g+="var "+i+" = numeric."+i+";\n")}return b.Function(["y"],"var x = this;\nif(!(y instanceof numeric.T)) { y = new numeric.T(y); }\n"+g+"\n"+"if(x.y) {"+"  if(y.y) {"+"    return new numeric.T("+f+");\n"+"  }\n"+"  return new numeric.T("+e+");\n"+"}\n"+"if(y.y) {\n"+"  return new numeric.T("+d+");\n"+"}\n"+"return new numeric.T("+c+");\n")},b.T.prototype.add=b.Tbinop("add(x.x,y.x)","add(x.x,y.x),y.y","add(x.x,y.x),x.y","add(x.x,y.x),add(x.y,y.y)"),b.T.prototype.sub=b.Tbinop("sub(x.x,y.x)","sub(x.x,y.x),neg(y.y)","sub(x.x,y.x),x.y","sub(x.x,y.x),sub(x.y,y.y)"),b.T.prototype.mul=b.Tbinop("mul(x.x,y.x)","mul(x.x,y.x),mul(x.x,y.y)","mul(x.x,y.x),mul(x.y,y.x)","sub(mul(x.x,y.x),mul(x.y,y.y)),add(mul(x.x,y.y),mul(x.y,y.x))"),b.T.prototype.reciprocal=function(){var c=b.mul,d=b.div;if(this.y){var e=b.add(c(this.x,this.x),c(this.y,this.y));return new b.T(d(this.x,e),d(b.neg(this.y),e))}return new T(d(1,this.x))},b.T.prototype.div=function f(a){a instanceof b.T||(a=new b.T(a));if(a.y)return this.mul(a.reciprocal());var f=b.div;return this.y?new b.T(f(this.x,a.x),f(this.y,a.x)):new b.T(f(this.x,a.x))},b.T.prototype.dot=b.Tbinop("dot(x.x,y.x)","dot(x.x,y.x),dot(x.x,y.y)","dot(x.x,y.x),dot(x.y,y.x)","sub(dot(x.x,y.x),dot(x.y,y.y)),add(dot(x.x,y.y),dot(x.y,y.x))"),b.T.prototype.transpose=function(){var c=b.transpose,d=this.x,e=this.y;return e?new b.T(c(d),c(e)):new b.T(c(d))},b.T.prototype.transjugate=function(){var c=b.transpose,d=this.x,e=this.y;return e?new b.T(c(d),b.negtranspose(e)):new b.T(c(d))},b.Tunop=function(c,d,e){return typeof e!="string"&&(e=""),b.Function("var x = this;\n"+e+"\n"+"if(x.y) {"+"  "+d+";\n"+"}\n"+c+";\n")},b.T.prototype.exp=b.Tunop("return new numeric.T(ex)","return new numeric.T(mul(cos(x.y),ex),mul(sin(x.y),ex))","var ex = numeric.exp(x.x), cos = numeric.cos, sin = numeric.sin, mul = numeric.mul;"),b.T.prototype.conj=b.Tunop("return new numeric.T(x.x);","return new numeric.T(x.x,numeric.neg(x.y));"),b.T.prototype.neg=b.Tunop("return new numeric.T(neg(x.x));","return new numeric.T(neg(x.x),neg(x.y));","var neg = numeric.neg;"),b.T.prototype.sin=b.Tunop("return new numeric.T(numeric.sin(x.x))","return x.exp().sub(x.neg().exp()).div(new numeric.T(0,2));"),b.T.prototype.cos=b.Tunop("return new numeric.T(numeric.cos(x.x))","return x.exp().add(x.neg().exp()).div(2);"),b.T.prototype.abs=b.Tunop("return new numeric.T(numeric.abs(x.x));","return new numeric.T(numeric.sqrt(numeric.add(mul(x.x,x.x),mul(x.y,x.y))));","var mul = numeric.mul;"),b.T.prototype.log=b.Tunop("return new numeric.T(numeric.log(x.x));","var theta = new numeric.T(numeric.atan2(x.y,x.x)), r = x.abs();\nreturn new numeric.T(numeric.log(r.x),theta.x);"),b.T.prototype.norm2=b.Tunop("return numeric.norm2(x.x);","var f = numeric.norm2Squared;\nreturn Math.sqrt(f(x.x)+f(x.y));"),b.T.prototype.inv=function(){var c=this;if(typeof c.y=="undefined")return new b.T(b.inv(c.x));var d=c.x.length,e,f,g,h=b.identity(d),i=b.rep([d,d],0),j=b.clone(c.x),k=b.clone(c.y),l,m,n,o,p,q,r,s,e,f,g,t,u,v,w,x,y,z;for(e=0;e<d;e++){v=j[e][e],w=k[e][e],t=v*v+w*w,g=e;for(f=e+1;f<d;f++)v=j[f][e],w=k[f][e],u=v*v+w*w,u>t&&(g=f,t=u);g!==e&&(z=j[e],j[e]=j[g],j[g]=z,z=k[e],k[e]=k[g],k[g]=z,z=h[e],h[e]=h[g],h[g]=z,z=i[e],i[e]=i[g],i[g]=z),l=j[e],m=k[e],p=h[e],q=i[e],v=l[e],w=m[e];for(f=e+1;f<d;f++)x=l[f],y=m[f],l[f]=(x*v+y*w)/t,m[f]=(y*v-x*w)/t;for(f=0;f<d;f++)x=p[f],y=q[f],p[f]=(x*v+y*w)/t,q[f]=(y*v-x*w)/t;for(f=e+1;f<d;f++){n=j[f],o=k[f],r=h[f],s=i[f],v=n[e],w=o[e];for(g=e+1;g<d;g++)x=l[g],y=m[g],n[g]-=x*v-y*w,o[g]-=y*v+x*w;for(g=0;g<d;g++)x=p[g],y=q[g],r[g]-=x*v-y*w,s[g]-=y*v+x*w}}for(e=d-1;e>0;e--){p=h[e],q=i[e];for(f=e-1;f>=0;f--){r=h[f],s=i[f],v=j[f][e],w=k[f][e];for(g=d-1;g>=0;g--)x=p[g],y=q[g],r[g]-=v*x-w*y,s[g]-=v*y+w*x}}return new b.T(h,i)},b.T.prototype.get=function(c){var d=this.x,e=this.y,f=0,g,h=c.length;if(e){while(f<h)g=c[f],d=d[g],e=e[g],f++;return new b.T(d,e)}while(f<h)g=c[f],d=d[g],f++;return new b.T(d)},b.T.prototype.set=function(c,d){var e=this.x,f=this.y,g=0,h,i=c.length,j=d.x,k=d.y;if(i===0)return k?this.y=k:f&&(this.y=undefined),this.x=e,this;if(k){f||(f=b.rep(b.dim(e),0),this.y=f);while(g<i-1)h=c[g],e=e[h],f=f[h],g++;return h=c[g],e[h]=j,f[h]=k,this}if(f){while(g<i-1)h=c[g],e=e[h],f=f[h],g++;return h=c[g],e[h]=j,j instanceof Array?f[h]=b.rep(b.dim(j),0):f[h]=0,this}while(g<i-1)h=c[g],e=e[h],g++;return h=c[g],e[h]=j,this},b.T.prototype.getRows=function(c,d){var e=d-c+1,f,g=Array(e),h,i=this.x,j=this.y;for(f=c;f<=d;f++)g[f-c]=i[f];if(j){h=Array(e);for(f=c;f<=d;f++)h[f-c]=j[f];return new b.T(g,h)}return new b.T(g)},b.T.prototype.setRows=function(c,d,e){var f,g=this.x,h=this.y,i=e.x,j=e.y;for(f=c;f<=d;f++)g[f]=i[f-c];if(j){h||(h=b.rep(b.dim(g),0),this.y=h);for(f=c;f<=d;f++)h[f]=j[f-c]}else if(h)for(f=c;f<=d;f++)h[f]=b.rep([i[f-c].length],0);return this},b.T.prototype.getRow=function(c){var d=this.x,e=this.y;return e?new b.T(d[c],e[c]):new b.T(d[c])},b.T.prototype.setRow=function(c,d){var e=this.x,f=this.y,g=d.x,h=d.y;return e[c]=g,h?(f||(f=b.rep(b.dim(e),0),this.y=f),f[c]=h):f&&(f=b.rep([g.length],0)),this},b.T.prototype.getBlock=function(c,d){var e=this.x,f=this.y,g=b.getBlock;return f?new b.T(g(e,c,d),g(f,c,d)):new b.T(g(e,c,d))},b.T.prototype.setBlock=function(c,d,e){e instanceof b.T||(e=new b.T(e));var f=this.x,g=this.y,h=b.setBlock,i=e.x,j=e.y;if(j)return g||(this.y=b.rep(b.dim(this),0),g=this.y),h(f,c,d,i),h(g,c,d,j),this;h(f,c,d,i),g&&h(g,c,d,b.rep(b.dim(i),0))},b.T.rep=function(c,d){var e=b.T;d instanceof e||(d=new e(d));var f=d.x,g=d.y,h=b.rep;return g?new e(h(c,f),h(c,g)):new e(h(c,f))},b.T.diag=function g(a){a instanceof b.T||(a=new b.T(a));var c=a.x,d=a.y,g=b.diag;return d?new b.T(g(c),g(d)):new b.T(g(c))},b.T.eig=function(){if(this.y)throw new Error("eig: not implemented for complex matrices.");return b.eig(this.x)},b.T.identity=function(c){return new b.T(b.identity(c))},b.T.prototype.getDiag=function(){var c=b,d=this.x,e=this.y;return e?new c.T(c.getDiag(d),c.getDiag(e)):new c.T(c.getDiag(d))},b.house=function(c){var d=b.clone(c),e=c[0]>=0?1:-1,f=e*b.norm2(c);d[0]+=f;var g=b.norm2(d);if(g===0)throw new Error("eig: internal error");return b.div(d,g)},b.toUpperHessenberg=function(c){var d=b.dim(c);if(d.length!==2||d[0]!==d[1])throw new Error("numeric: toUpperHessenberg() only works on square matrices");var e=d[0],f,g,h,i,j,k=b.clone(c),l,m,n,o,p=b.identity(e),q;for(g=0;g<e-2;g++){i=Array(e-g-1);for(f=g+1;f<e;f++)i[f-g-1]=k[f][g];j=b.house(i),l=b.getBlock(k,[g+1,g],[e-1,e-1]),m=b.tensor(j,b.dot(j,l));for(f=g+1;f<e;f++){n=k[f],o=m[f-g-1];for(h=g;h<e;h++)n[h]-=2*o[h-g]}l=b.getBlock(k,[0,g+1],[e-1,e-1]),m=b.tensor(b.dot(l,j),j);for(f=0;f<e;f++){n=k[f],o=m[f];for(h=g+1;h<e;h++)n[h]-=2*o[h-g-1]}l=Array(e-g-1);for(f=g+1;f<e;f++)l[f-g-1]=p[f];m=b.tensor(j,b.dot(j,l));for(f=g+1;f<e;f++){q=p[f],o=m[f-g-1];for(h=0;h<e;h++)q[h]-=2*o[h]}}return{H:k,Q:p}},b.epsilon=2.220446049250313e-16,b.QRFrancis=function(a,c){typeof c=="undefined"&&(c=1e4),a=b.clone(a);var d=b.clone(a),e=b.dim(a),f=e[0],g,h,i,j,k,l,m,n,o,p=b.identity(f),q,r,s,t,u,v,w,x,y;if(f<3)return{Q:p,B:[[0,f-1]]};var z=b.epsilon;for(y=0;y<c;y++){for(w=0;w<f-1;w++)if(Math.abs(a[w+1][w])<z*(Math.abs(a[w][w])+Math.abs(a[w+1][w+1]))){var A=b.QRFrancis(b.getBlock(a,[0,0],[w,w]),c),B=b.QRFrancis(b.getBlock(a,[w+1,w+1],[f-1,f-1]),c);s=Array(w+1);for(v=0;v<=w;v++)s[v]=p[v];t=b.dot(A.Q,s);for(v=0;v<=w;v++)p[v]=t[v];s=Array(f-w-1);for(v=w+1;v<f;v++)s[v-w-1]=p[v];t=b.dot(B.Q,s);for(v=w+1;v<f;v++)p[v]=t[v-w-1];return{Q:p,B:A.B.concat(b.add(B.B,w+1))}}i=a[f-2][f-2],j=a[f-2][f-1],k=a[f-1][f-2],l=a[f-1][f-1],n=i+l,m=i*l-j*k,o=b.getBlock(a,[0,0],[2,2]);if(n*n>=4*m){var C,D;C=.5*(n+Math.sqrt(n*n-4*m)),D=.5*(n-Math.sqrt(n*n-4*m)),o=b.add(b.sub(b.dot(o,o),b.mul(o,C+D)),b.diag(b.rep([3],C*D)))}else o=b.add(b.sub(b.dot(o,o),b.mul(o,n)),b.diag(b.rep([3],m)));g=[o[0][0],o[1][0],o[2][0]],h=b.house(g),s=[a[0],a[1],a[2]],t=b.tensor(h,b.dot(h,s));for(v=0;v<3;v++){r=a[v],u=t[v];for(x=0;x<f;x++)r[x]-=2*u[x]}s=b.getBlock(a,[0,0],[f-1,2]),t=b.tensor(b.dot(s,h),h);for(v=0;v<f;v++){r=a[v],u=t[v];for(x=0;x<3;x++)r[x]-=2*u[x]}s=[p[0],p[1],p[2]],t=b.tensor(h,b.dot(h,s));for(v=0;v<3;v++){q=p[v],u=t[v];for(x=0;x<f;x++)q[x]-=2*u[x]}var E;for(w=0;w<f-2;w++){for(x=w;x<=w+1;x++)if(Math.abs(a[x+1][x])<z*(Math.abs(a[x][x])+Math.abs(a[x+1][x+1]))){var A=b.QRFrancis(b.getBlock(a,[0,0],[x,x]),c),B=b.QRFrancis(b.getBlock(a,[x+1,x+1],[f-1,f-1]),c);s=Array(x+1);for(v=0;v<=x;v++)s[v]=p[v];t=b.dot(A.Q,s);for(v=0;v<=x;v++)p[v]=t[v];s=Array(f-x-1);for(v=x+1;v<f;v++)s[v-x-1]=p[v];t=b.dot(B.Q,s);for(v=x+1;v<f;v++)p[v]=t[v-x-1];return{Q:p,B:A.B.concat(b.add(B.B,x+1))}}E=Math.min(f-1,w+3),g=Array(E-w);for(v=w+1;v<=E;v++)g[v-w-1]=a[v][w];h=b.house(g),s=b.getBlock(a,[w+1,w],[E,f-1]),t=b.tensor(h,b.dot(h,s));for(v=w+1;v<=E;v++){r=a[v],u=t[v-w-1];for(x=w;x<f;x++)r[x]-=2*u[x-w]}s=b.getBlock(a,[0,w+1],[f-1,E]),t=b.tensor(b.dot(s,h),h);for(v=0;v<f;v++){r=a[v],u=t[v];for(x=w+1;x<=E;x++)r[x]-=2*u[x-w-1]}s=Array(E-w);for(v=w+1;v<=E;v++)s[v-w-1]=p[v];t=b.tensor(h,b.dot(h,s));for(v=w+1;v<=E;v++){q=p[v],u=t[v-w-1];for(x=0;x<f;x++)q[x]-=2*u[x]}}}throw new Error("numeric: eigenvalue iteration does not converge -- increase maxiter?")},b.eig=function(c,d){var e=b.toUpperHessenberg(c),f=b.QRFrancis(e.H,d),g=b.T,h=c.length,i,j,k=!1,l=f.B,m=b.dot(f.Q,b.dot(e.H,b.transpose(f.Q))),n=new g(b.dot(f.Q,e.Q)),o,p=l.length,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E=Math.sqrt;for(j=0;j<p;j++){i=l[j][0];if(i!==l[j][1]){q=i+1,r=m[i][i],s=m[i][q],t=m[q][i],u=m[q][q];if(s===0&&t===0)continue;v=-r-u,w=r*u-s*t,x=v*v-4*w,x>=0?(v<0?y=-0.5*(v-E(x)):y=-0.5*(v+E(x)),C=(r-y)*(r-y)+s*s,D=t*t+(u-y)*(u-y),C>D?(C=E(C),A=(r-y)/C,B=s/C):(D=E(D),A=t/D,B=(u-y)/D),o=new g([[B,-A],[A,B]]),n.setRows(i,q,o.dot(n.getRows(i,q)))):(y=-0.5*v,z=.5*E(-x),C=(r-y)*(r-y)+s*s,D=t*t+(u-y)*(u-y),C>D?(C=E(C+z*z),A=(r-y)/C,B=s/C,y=0,z/=C):(D=E(D+z*z),A=t/D,B=(u-y)/D,y=z/D,z=0),o=new g([[B,-A],[A,B]],[[y,z],[z,-y]]),n.setRows(i,q,o.dot(n.getRows(i,q))))}}var F=n.dot(c).dot(n.transjugate()),h=c.length,G=b.T.identity(h);for(q=0;q<h;q++)if(q>0)for(j=q-1;j>=0;j--){var H=F.get([j,j]),I=F.get([q,q]);if(!b.neq(H.x,I.x)&&!b.neq(H.y,I.y)){G.setRow(q,G.getRow(j));continue}y=F.getRow(j).getBlock([j],[q-1]),z=G.getRow(q).getBlock([j],[q-1]),G.set([q,j],F.get([j,q]).neg().sub(y.dot(z)).div(H.sub(I)))}for(q=0;q<h;q++)y=G.getRow(q),G.setRow(q,y.div(y.norm2()));return G=G.transpose(),G=n.transjugate().dot(G),{lambda:F.getDiag(),E:G}},b.sdim=function h(a,b,c){typeof b=="undefined"&&(b=[]);if(typeof a!="object")return b;typeof c=="undefined"&&(c=0),c in b||(b[c]=0),a.length>b[c]&&(b[c]=a.length);var d;for(d in a)a.hasOwnProperty(d)&&h(a[d],b,c+1);return b},b.sclone=function i(a,c,d){typeof c=="undefined"&&(c=0),typeof d=="undefined"&&(d=b.sdim(a).length);var e,f=Array(a.length);if(c===d-1){for(e in a)a.hasOwnProperty(e)&&(f[e]=a[e]);return f}for(e in a)a.hasOwnProperty(e)&&(f[e]=i(a[e],c+1,d));return f},b.sdiag=function(b){var c=b.length,d,e=Array(c),f,g,h;for(d=c-1;d>=1;d-=2)f=d-1,e[d]=[],e[d][d]=b[d],e[f]=[],e[f][f]=b[f];return d===0&&(e[0]=[],e[0][0]=b[d]),e},b.sidentity=function(c){return b.sdiag(b.rep([c],1))},b.stranspose=function(b){var c=[],d=b.length,e,f,g;for(e in b){if(!b.hasOwnProperty(e))continue;g=b[e];for(f in g){if(!g.hasOwnProperty(f))continue;typeof c[f]!="object"&&(c[f]=[]),c[f][e]=g[f]}}return c},b.sLUP=function(c,d){typeof d=="undefined"&&(d=1);var e=c.length,f,g,h,i=b.sidentity(e),j=b.sclone(c),k=b.stranspose(j),l=b.linspace(0,e-1),m=b.linspace(0,e-1),n,o,p,q,r,s=Math.abs;for(f=0;f<e-1;f++){p=k[f],g=f;for(h in p){if(!m.hasOwnProperty(h))continue;h=m[h];if(h<=f)continue;s(j[h][f])>s(j[g][f])&&(g=h)}s(j[f][f])>=d*s(j[g][f])&&(g=f);if(g!==f){q=j[f],j[f]=j[g],j[g]=q,q=i[f],i[f]=i[g],i[g]=q,q=l[f],l[f]=l[g],l[g]=q,m=Array(e);for(g=0;g<e;g++)m[l[g]]=g}n=j[f];for(g in p){if(!m.hasOwnProperty(g))continue;g=m[g];if(g<=f)continue;o=j[g],r=o[f]/n[f],i[g][f]=r;for(h in n){if(!n.hasOwnProperty(h))continue;h>f?(h in o||(o[h]=0,k[h][g]=0),o[h]-=r*n[h]):delete o[h]}}}return{L:i,U:j,P:l,Pinv:m}},b.sdotMM=function(c,d){var e=c.length,f=d.length,g=b.stranspose(d),h=g.length,i,j,k,l,m,n,o=Array(e),p;for(k=e-1;k>=0;k--){p=[],i=c[k];for(m=h-1;m>=0;m--){n=0,j=g[m];for(l in i){if(!i.hasOwnProperty(l))continue;l in j&&(n+=i[l]*j[l])}n&&(p[m]=n)}o[k]=p}return o},b.sdotMV=function(b,c){var d=b.length,e,f,g,h=Array(d),i;for(f=d-1;f>=0;f--){e=b[f],i=0;for(g in e){if(!e.hasOwnProperty(g))continue;c[g]&&(i+=e[g]*c[g])}i&&(h[f]=i)}return h},b.sdotVM=function(b,c){var d,e,f,g,h=[],i;for(d in b){if(!b.hasOwnProperty(d))continue;f=c[d],g=b[d];for(e in f){if(!f.hasOwnProperty(e))continue;h[e]||(h[e]=0),h[e]+=g*f[e]}}return h},b.sdotVV=function(b,c){var d,e=0;for(d in b)b[d]&&c[d]&&(e+=b[d]*c[d]);return e},b.sdot=function(c,d){var e=b.sdim(c).length,f=b.sdim(d).length,g=e*1e3+f;switch(g){case 0:return c*d;case 1001:return b.sdotVV(c,d);case 2001:return b.sdotMV(c,d);case 1002:return b.sdotVM(c,d);case 2002:return b.sdotMM(c,d);default:throw new Error("numeric.sdot not implemented for tensors of order "+e+" and "+f)}},b.sLUPsolve=function(b,c){var d=b.L,e=b.U,f=b.P,g=d.length,h,i,j=Array(g),k,l,m;for(h=0;h<g;h++){c.hasOwnProperty(f[h])?k=c[f[h]]:k=0,l=d[h];for(i in l){if(!l.hasOwnProperty(i))continue;i<h&&(k-=l[i]*j[i])}j[h]=k}for(h=g-1;h>=0;h--){k=j[h],l=e[h];for(i in l){if(!l.hasOwnProperty(i))continue;i>h&&(k-=l[i]*j[i])}j[h]=k/l[h]}return j},b.sscatter=function(b){var c=b[0].length,d,e,f,g=b.length,h=[],i;for(e=c-1;e>=0;--e){if(!b[g-1][e])continue;i=h;for(f=0;f<g-2;f++)d=b[f][e],i[d]||(i[d]=[]),i=i[d];i[b[f][e]]=b[f+1][e]}return h},b.sgather=function j(a,b,c){typeof b=="undefined"&&(b=[]),typeof c=="undefined"&&(c=[]);var d,e,f;d=c.length;for(e in a)if(a.hasOwnProperty(e)){c[d]=parseInt(e),f=a[e];if(typeof f=="number"){if(f){if(b.length===0)for(e=d+1;e>=0;--e)b[e]=[];for(e=d;e>=0;--e)b[e].push(c[e]);b[d+1].push(f)}}else j(f,b,c)}return c.length>d&&c.pop(),b},b.cLU=function(c){var d=c[0],e=c[1],f=c[2],g=d.length,h=0,i,j,k,l,m,n;for(i=0;i<g;i++)d[i]>h&&(h=d[i]);h++;var o=Array(h),p=Array(h),q=b.rep([h],Infinity),r=b.rep([h],-Infinity),s,t,u;for(k=0;k<g;k++)i=d[k],j=e[k],j<q[i]&&(q[i]=j),j>r[i]&&(r[i]=j);for(i=0;i<h-1;i++)r[i]>r[i+1]&&(r[i+1]=r[i]);for(i=h-1;i>=1;i--)q[i]<q[i-1]&&(q[i-1]=q[i]);var v=0
,w=0;for(i=0;i<h;i++)p[i]=b.rep([r[i]-q[i]+1],0),o[i]=b.rep([i-q[i]],0),v+=i-q[i]+1,w+=r[i]-i+1;for(k=0;k<g;k++)i=d[k],p[i][e[k]-q[i]]=f[k];for(i=0;i<h-1;i++){l=i-q[i],s=p[i];for(j=i+1;q[j]<=i&&j<h;j++){m=i-q[j],n=r[i]-i,t=p[j],u=t[m]/s[l];if(u){for(k=1;k<=n;k++)t[k+m]-=u*s[k+l];o[j][i-q[j]]=u}}}var s=[],t=[],x=[],y=[],z=[],A=[],g,B,C;g=0,B=0;for(i=0;i<h;i++){l=q[i],m=r[i],C=p[i];for(j=i;j<=m;j++)C[j-l]&&(s[g]=i,t[g]=j,x[g]=C[j-l],g++);C=o[i];for(j=l;j<i;j++)C[j-l]&&(y[B]=i,z[B]=j,A[B]=C[j-l],B++);y[B]=i,z[B]=i,A[B]=1,B++}return{U:[s,t,x],L:[y,z,A]}},b.cLUsolve=function(c,d){var e=c.L,f=c.U,g=b.clone(d),h=e[0],i=e[1],j=e[2],k=f[0],l=f[1],m=f[2],n=k.length,o=h.length,p=g.length,q,r,s;s=0;for(q=0;q<p;q++){while(i[s]<q)g[q]-=j[s]*g[i[s]],s++;s++}s=n-1;for(q=p-1;q>=0;q--){while(l[s]>q)g[q]-=m[s]*g[l[s]],s--;g[q]/=m[s],s--}return g},b.cgrid=function(c,d){typeof c=="number"&&(c=[c,c]);var e=b.rep(c,-1),f,g,h;if(typeof d!="function")switch(d){case"L":d=function(a,b){return a>=c[0]/2||b<c[1]/2};break;default:d=function(a,b){return!0}}h=0;for(f=1;f<c[0]-1;f++)for(g=1;g<c[1]-1;g++)d(f,g)&&(e[f][g]=h,h++);return e},b.cdelsq=function(c){var d=[[-1,0],[0,-1],[0,1],[1,0]],e=b.dim(c),f=e[0],g=e[1],h,i,j,k,l,m=[],n=[],o=[];for(h=1;h<f-1;h++)for(i=1;i<g-1;i++){if(c[h][i]<0)continue;for(j=0;j<4;j++){k=h+d[j][0],l=i+d[j][1];if(c[k][l]<0)continue;m.push(c[h][i]),n.push(c[k][l]),o.push(-1)}m.push(c[h][i]),n.push(c[h][i]),o.push(4)}return[m,n,o]},b.cdotMV=function(c,d){var e,f=c[0],g=c[1],h=c[2],i,j=f.length,k;k=0;for(i=0;i<j;i++)f[i]>k&&(k=f[i]);k++,e=b.rep([k],0);for(i=0;i<j;i++)e[f[i]]+=h[i]*d[g[i]];return e},b.Spline=function(b,c,d,e,f){this.x=b,this.yl=c,this.yr=d,this.kl=e,this.kr=f},b.Spline.prototype._at=function(c,d){var e=this.x,f=this.yl,g=this.yr,h=this.kl,i=this.kr,c,j,k,l,m=b.add,n=b.sub,o=b.mul;j=n(o(h[d],e[d+1]-e[d]),n(g[d+1],f[d])),k=m(o(i[d+1],e[d]-e[d+1]),n(g[d+1],f[d])),l=(c-e[d])/(e[d+1]-e[d]);var p=l*(1-l);return m(m(m(o(1-l,f[d]),o(l,g[d+1])),o(j,p*(1-l))),o(k,p*l))},b.Spline.prototype.at=function(b){if(typeof b=="number"){var c=this.x,d=c.length,e,f,g,h=Math.floor,i,j,k;e=0,f=d-1;while(f-e>1)g=h((e+f)/2),c[g]<=b?e=g:f=g;return this._at(b,e)}var d=b.length,l,m=Array(d);for(l=d-1;l!==-1;--l)m[l]=this.at(b[l]);return m},b.Spline.prototype.diff=function(){var c=this.x,d=this.yl,e=this.yr,f=this.kl,g=this.kr,h=d.length,i,j,k,l=f,m=g,n=Array(h),o=Array(h),p=b.add,q=b.mul,r=b.div,s=b.sub;for(i=h-1;i!==-1;--i)j=c[i+1]-c[i],k=s(e[i+1],d[i]),n[i]=r(p(q(k,6),q(f[i],-4*j),q(g[i+1],-2*j)),j*j),o[i+1]=r(p(q(k,-6),q(f[i],2*j),q(g[i+1],4*j)),j*j);return new b.Spline(c,l,m,n,o)},b.Spline.prototype.roots=function(){function b(a){return a*a}function c(a,b,c,d,e){var f=c*2-(b-a),g=-d*2+(b-a),h=(e+1)*.5,i=h*(1-h);return(1-h)*a+h*b+f*i*(1-h)+g*i*h}var d=[],e=this.x,f=this.yl,g=this.yr,h=this.kl,i=this.kr;typeof f[0]=="number"&&(f=[f],g=[g],h=[h],i=[i]);var j=f.length,k=e.length-1,l,m,n,o,p,q,r,s,t,u,d=Array(j),v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M=Math.sqrt;for(l=0;l!==j;++l){r=f[l],s=g[l],t=h[l],u=i[l],v=[];for(m=0;m!==k;m++){m>0&&s[m]*r[m]<0&&v.push(e[m]),D=e[m+1]-e[m],E=e[m],y=r[m],z=s[m+1],w=t[m]/D,x=u[m+1]/D,C=b(w-x+3*(y-z))+12*x*y,A=x+3*y+2*w-3*z,B=3*(x+w+2*(y-z)),C<=0?(G=A/B,G>e[m]&&G<e[m+1]?F=[e[m],G,e[m+1]]:F=[e[m],e[m+1]]):(G=(A-M(C))/B,H=(A+M(C))/B,F=[e[m]],G>e[m]&&G<e[m+1]&&F.push(G),H>e[m]&&H<e[m+1]&&F.push(H),F.push(e[m+1])),J=F[0],G=this._at(J,m);for(n=0;n<F.length-1;n++){K=F[n+1],H=this._at(K,m);if(G===0){v.push(J),J=K,G=H;continue}if(H===0||G*H>0){J=K,G=H;continue}var N=0;for(;;){L=(G*K-H*J)/(G-H);if(L<=J||L>=K)break;I=this._at(L,m);if(I*H>0)K=L,H=I,N===-1&&(G*=.5),N=-1;else{if(!(I*G>0))break;J=L,G=I,N===1&&(H*=.5),N=1}}v.push(L),J=F[n+1],G=this._at(J,m)}H===0&&v.push(K)}d[l]=v}return typeof this.yl[0]=="number"?d[0]:d},b.spline=function(c,d,e,f){var g=c.length,h=[],i=[],j=[],k,l=b.sub,m=b.mul,n=b.add;for(k=g-2;k>=0;k--)i[k]=c[k+1]-c[k],j[k]=l(d[k+1],d[k]);if(typeof e=="string"||typeof f=="string")e=f="periodic";var o=[[],[],[]];switch(typeof e){case"undefined":h[0]=m(3/(i[0]*i[0]),j[0]),o[0].push(0,0),o[1].push(0,1),o[2].push(2/i[0],1/i[0]);break;case"string":h[0]=n(m(3/(i[g-2]*i[g-2]),j[g-2]),m(3/(i[0]*i[0]),j[0])),o[0].push(0,0,0),o[1].push(g-2,0,1),o[2].push(1/i[g-2],2/i[g-2]+2/i[0],1/i[0]);break;default:h[0]=e,o[0].push(0),o[1].push(0),o[2].push(1)}for(k=1;k<g-1;k++)h[k]=n(m(3/(i[k-1]*i[k-1]),j[k-1]),m(3/(i[k]*i[k]),j[k])),o[0].push(k,k,k),o[1].push(k-1,k,k+1),o[2].push(1/i[k-1],2/i[k-1]+2/i[k],1/i[k]);switch(typeof f){case"undefined":h[g-1]=m(3/(i[g-2]*i[g-2]),j[g-2]),o[0].push(g-1,g-1),o[1].push(g-2,g-1),o[2].push(1/i[g-2],2/i[g-2]);break;case"string":o[1][o[1].length-1]=0;break;default:h[g-1]=f,o[0].push(g-1),o[1].push(g-1),o[2].push(1)}typeof h[0]!="number"?h=b.transpose(h):h=[h];var p=Array(h.length);if(typeof e=="string")for(k=p.length-1;k!==-1;--k)p[k]=b.sLUPsolve(b.sLUP(b.sscatter(o)),h[k]),p[k][g-1]=p[k][0];else for(k=p.length-1;k!==-1;--k)p[k]=b.cLUsolve(b.cLU(o),h[k]);return typeof d[0]=="number"?p=p[0]:p=b.transpose(p),new b.Spline(c,d,d,p,p)},b.fftpow2=function k(a,b){var c=a.length;if(c===1)return;var d=Math.cos,e=Math.sin,f,g,h=Array(c/2),i=Array(c/2),j=Array(c/2),l=Array(c/2);g=c/2;for(f=c-1;f!==-1;--f)--g,j[g]=a[f],l[g]=b[f],--f,h[g]=a[f],i[g]=b[f];k(h,i),k(j,l),g=c/2;var m,n=-6.283185307179586/c,o,p;for(f=c-1;f!==-1;--f)--g,g===-1&&(g=c/2-1),m=n*f,o=d(m),p=e(m),a[f]=h[g]+o*j[g]-p*l[g],b[f]=i[g]+o*l[g]+p*j[g]},b._ifftpow2=function l(a,b){var c=a.length;if(c===1)return;var d=Math.cos,e=Math.sin,f,g,h=Array(c/2),i=Array(c/2),j=Array(c/2),k=Array(c/2);g=c/2;for(f=c-1;f!==-1;--f)--g,j[g]=a[f],k[g]=b[f],--f,h[g]=a[f],i[g]=b[f];l(h,i),l(j,k),g=c/2;var m,n=6.283185307179586/c,o,p;for(f=c-1;f!==-1;--f)--g,g===-1&&(g=c/2-1),m=n*f,o=d(m),p=e(m),a[f]=h[g]+o*j[g]-p*k[g],b[f]=i[g]+o*k[g]+p*j[g]},b.ifftpow2=function(c,d){b._ifftpow2(c,d),b.diveq(c,c.length),b.diveq(d,d.length)},b.convpow2=function(c,d,e,f){b.fftpow2(c,d),b.fftpow2(e,f);var g,h=c.length,i,j,k,l;for(g=h-1;g!==-1;--g)i=c[g],k=d[g],j=e[g],l=f[g],c[g]=i*j-k*l,d[g]=i*l+k*j;b.ifftpow2(c,d)},b.T.prototype.fft=function(){var c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=b.rep([i],0),k=b.rep([i],0),l=Math.cos,m=Math.sin,n,o=-3.141592653589793/e,p,q=b.rep([i],0),r=b.rep([i],0),s=Math.floor(e/2);for(n=0;n<e;n++)q[n]=c[n];if(typeof d!="undefined")for(n=0;n<e;n++)r[n]=d[n];j[0]=1;for(n=1;n<=i/2;n++)p=o*n*n,j[n]=l(p),k[n]=m(p),j[i-n]=l(p),k[i-n]=m(p);var t=new b.T(q,r),u=new b.T(j,k);return t=t.mul(u),b.convpow2(t.x,t.y,b.clone(u.x),b.neg(u.y)),t=t.mul(u),t.x.length=e,t.y.length=e,t},b.T.prototype.ifft=function(){var c=this.x,d=this.y,e=c.length,f=Math.log,g=f(2),h=Math.ceil(f(2*e-1)/g),i=Math.pow(2,h),j=b.rep([i],0),k=b.rep([i],0),l=Math.cos,m=Math.sin,n,o=3.141592653589793/e,p,q=b.rep([i],0),r=b.rep([i],0),s=Math.floor(e/2);for(n=0;n<e;n++)q[n]=c[n];if(typeof d!="undefined")for(n=0;n<e;n++)r[n]=d[n];j[0]=1;for(n=1;n<=i/2;n++)p=o*n*n,j[n]=l(p),k[n]=m(p),j[i-n]=l(p),k[i-n]=m(p);var t=new b.T(q,r),u=new b.T(j,k);return t=t.mul(u),b.convpow2(t.x,t.y,b.clone(u.x),b.neg(u.y)),t=t.mul(u),t.x.length=e,t.y.length=e,t.div(e)},b.gradient=function(c,d){var e=d.length,f=c(d),g=Math.max,h,i=b.clone(d),j,k,l=Array(e),m=b.div,n=b.sub,o,p,g=Math.max,q=.001,r=Math.abs,s=Math.min,t,u,v,w=0,x,y,z;for(h=0;h<e;h++){var A=g(1e-6*f,1e-8);for(;;){++w;if(w>20)throw new Error("Numerical gradient fails");i[h]=d[h]+A,j=c(i),i[h]=d[h]-A,k=c(i),i[h]=d[h],l[h]=(j-k)/(2*A),t=d[h]-A,u=d[h],v=d[h]+A,x=(j-f)/A,y=(f-k)/A,z=g(r(l[h]),r(f),r(j),r(k),r(t),r(u),r(v),1e-8),o=s(g(r(x-l[h]),r(y-l[h]),r(x-y))/z,A/z);if(!(o>q))break;A/=16}}return l},b.uncmin=function(c,d,e,f,g,h){var i=b.gradient;typeof e=="undefined"&&(e=1e-8),typeof f=="undefined"&&(f=function(a){return i(c,a)}),typeof g=="undefined"&&(g=1e3),d=b.clone(d);var j=d.length,k=c(d),l,m,n=Math.max,o=b.norm2;e=n(e,b.epsilon);var p,q,r,s=b.identity(j),t=b.dot,u=b.inv,v=b.sub,w=b.add,x=b.tensor,y=b.div,z=b.mul,A=b.all,B=b.isFinite,C=b.neg,D=0,E,F,G,H,I,J,K,L,M,N,O,P,Q="";q=f(d);while(D<g){typeof h=="function"&&h(D,d,k,q,s);if(!A(B(q))){Q="Gradient has Infinity or NaN";break}p=C(t(s,q));if(!A(B(p))){Q="Search direction has Infinity or NaN";break}N=o(p);if(N<e){Q="Newton step smaller than tol";break}M=1,m=t(q,p);while(D<g){if(M*N<e)break;F=z(p,M),G=w(d,F),l=c(G);if(l-k>=.1*M*m){M*=.5,++D;continue}break}if(M*N<e){Q="Line search step size smaller than tol";break}if(D===g){Q="maxit reached during line search";break}r=f(G),H=v(r,q),K=t(H,F),I=t(s,H),s=v(w(s,z((K+t(H,I))/(K*K),x(F,F))),y(w(x(I,F),x(F,I)),K)),d=G,k=l,q=r,++D}return{solution:d,f:k,gradient:q,invHessian:s,iterations:D,message:Q}},b.Dopri=function(b,c,d,e,f,g,h){this.x=b,this.y=c,this.f=d,this.ymid=e,this.iterations=f,this.events=h,this.message=g},b.Dopri.prototype._at=function(c,d){function e(a){return a*a}var f=this,g=f.x,h=f.y,i=f.f,j=f.ymid,k=g.length,l,m,n,o,p,q,c,r=Math.floor,s,t=.5,u=b.add,v=b.mul,w=b.sub,x,y,z;return l=g[d],m=g[d+1],o=h[d],p=h[d+1],s=m-l,n=l+t*s,q=j[d],x=w(i[d],v(o,1/(l-n)+2/(l-m))),y=w(i[d+1],v(p,1/(m-n)+2/(m-l))),z=[e(c-m)*(c-n)/e(l-m)/(l-n),e(c-l)*e(c-m)/e(l-n)/e(m-n),e(c-l)*(c-n)/e(m-l)/(m-n),(c-l)*e(c-m)*(c-n)/e(l-m)/(l-n),(c-m)*e(c-l)*(c-n)/e(l-m)/(m-n)],u(u(u(u(v(o,z[0]),v(q,z[1])),v(p,z[2])),v(x,z[3])),v(y,z[4]))},b.Dopri.prototype.at=function(b){var c,d,e,f=Math.floor;if(typeof b!="number"){var g=b.length,h=Array(g);for(c=g-1;c!==-1;--c)h[c]=this.at(b[c]);return h}var i=this.x;c=0,d=i.length-1;while(d-c>1)e=f(.5*(c+d)),i[e]<=b?c=e:d=e;return this._at(b,c)},b.dopri=function(c,d,e,f,g,h,i){typeof g=="undefined"&&(g=1e-6),typeof h=="undefined"&&(h=1e3);var j=[c],k=[e],l=[f(c,e)],m,n,o,p,q,r,s=[],t=.2,u=[.075,.225],v=[44/45,-56/15,32/9],w=[19372/6561,-25360/2187,64448/6561,-212/729],x=[9017/3168,-355/33,46732/5247,49/176,-5103/18656],y=[35/384,0,500/1113,125/192,-2187/6784,11/84],z=[.10013431883002395,0,.3918321794184259,-0.02982460176594817,.05893268337240795,-0.04497888809104361,.023904308236133973],A=[.2,.3,.8,8/9,1,1],B=[-71/57600,0,71/16695,-71/1920,17253/339200,-22/525,.025],C=0,D,E,F=(d-c)/10,G=0,H=b.add,I=b.mul,J,K,L=Math.max,M=Math.min,N=Math.abs,O=b.norminf,P=Math.pow,Q=b.any,R=b.lt,S=b.and,T=b.sub,U,V,W,X=new b.Dopri(j,k,l,s,-1,"");typeof i=="function"&&(U=i(c,e));while(c<d&&G<h){++G,c+F>d&&(F=d-c),m=f(c+A[0]*F,H(e,I(t*F,l[C]))),n=f(c+A[1]*F,H(H(e,I(u[0]*F,l[C])),I(u[1]*F,m))),o=f(c+A[2]*F,H(H(H(e,I(v[0]*F,l[C])),I(v[1]*F,m)),I(v[2]*F,n))),p=f(c+A[3]*F,H(H(H(H(e,I(w[0]*F,l[C])),I(w[1]*F,m)),I(w[2]*F,n)),I(w[3]*F,o))),q=f(c+A[4]*F,H(H(H(H(H(e,I(x[0]*F,l[C])),I(x[1]*F,m)),I(x[2]*F,n)),I(x[3]*F,o)),I(x[4]*F,p))),J=H(H(H(H(H(e,I(l[C],F*y[0])),I(n,F*y[2])),I(o,F*y[3])),I(p,F*y[4])),I(q,F*y[5])),r=f(c+F,J),D=H(H(H(H(H(I(l[C],F*B[0]),I(n,F*B[2])),I(o,F*B[3])),I(p,F*B[4])),I(q,F*B[5])),I(r,F*B[6])),typeof D=="number"?K=N(D):K=O(D);if(K>g){F=.2*F*P(g/K,.25);if(c+F===c){X.msg="Step size became too small";break}continue}s[C]=H(H(H(H(H(H(e,I(l[C],F*z[0])),I(n,F*z[2])),I(o,F*z[3])),I(p,F*z[4])),I(q,F*z[5])),I(r,F*z[6])),++C,j[C]=c+F,k[C]=J,l[C]=r;if(typeof i=="function"){var Y,Z=c,$=c+.5*F,_;V=i($,s[C-1]),W=S(R(U,0),R(0,V)),Q(W)||(Z=$,$=c+F,U=V,V=i($,J),W=S(R(U,0),R(0,V)));if(Q(W)){var ab,bb,cb,db,eb=0,fb=1,gb=1;for(;;){if(typeof U=="number")_=(gb*V*Z-fb*U*$)/(gb*V-fb*U);else{_=$;for(E=U.length-1;E!==-1;--E)U[E]<0&&V[E]>0&&(_=M(_,(gb*V[E]*Z-fb*U[E]*$)/(gb*V[E]-fb*U[E])))}if(_<=Z||_>=$)break;Y=X._at(_,C-1),db=i(_,Y),cb=S(R(U,0),R(0,db)),Q(cb)?($=_,V=db,W=cb,gb=1,eb===-1?fb*=.5:fb=1,eb=-1):(Z=_,U=db,fb=1,eb===1?gb*=.5:gb=1,eb=1)}return J=X._at(.5*(c+_),C-1),X.f[C]=f(_,Y),X.x[C]=_,X.y[C]=Y,X.ymid[C-1]=J,X.events=W,X.iterations=G,X}}c+=F,e=J,U=V,F=M(.8*F*P(g/K,.25),4*F)}return X.iterations=G,X},b.seedrandom={pow:Math.pow,random:Math.random},function(a,b,c,d,e,f,g){function h(a){var b,d,e=this,f=a.length,g=0,h=e.i=e.j=e.m=0;e.S=[],e.c=[],f||(a=[f++]);while(g<c)e.S[g]=g++;for(g=0;g<c;g++)b=e.S[g],h=k(h+b+a[g%f]),d=e.S[h],e.S[g]=d,e.S[h]=b;e.g=function(b){var d=e.S,f=k(e.i+1),g=d[f],h=k(e.j+g),i=d[h];d[f]=i,d[h]=g;var j=d[k(g+i)];while(--b)f=k(f+1),g=d[f],h=k(h+g),i=d[h],d[f]=i,d[h]=g,j=j*c+d[k(g+i)];return e.i=f,e.j=h,j},e.g(c)}function i(a,b,c,d,e){c=[],e=typeof a;if(b&&e=="object")for(d in a)if(d.indexOf("S")<5)try{c.push(i(a[d],b-1))}catch(f){}return c.length?c:a+(e!="string"?"\0":"")}function j(a,b,c,d){a+="",c=0;for(d=0;d<a.length;d++)b[k(d)]=k((c^=b[k(d)]*19)+a.charCodeAt(d));a="";for(d in b)a+=String.fromCharCode(b[d]);return a}function k(a){return a&c-1}b.seedrandom=function(l,m){var n=[],o;return l=j(i(m?[l,a]:arguments.length?l:[(new Date).getTime(),a,window],3),n),o=new h(n),j(o.S,a),b.random=function(){var b=o.g(d),h=g,i=0;while(b<e)b=(b+i)*c,h*=c,i=o.g(1);while(b>=f)b/=2,h/=2,i>>>=1;return(b+i)/h},l},g=b.pow(c,d),e=b.pow(2,e),f=e*2,j(b.random(),a)}([],b.seedrandom,256,6,52),function(a){function b(a){if(typeof a!="object")return a;var c=[],d,e=a.length;for(d=0;d<e;d++)c[d+1]=b(a[d]);return c}function c(a){if(typeof a!="object")return a;var b=[],d,e=a.length;for(d=1;d<e;d++)b[d-1]=c(a[d]);return b}function d(a,b,c){var d,e,f,g,h;for(f=1;f<=c;f+=1){a[f][f]=1/a[f][f],h=-a[f][f];for(d=1;d<f;d+=1)a[d][f]=h*a[d][f];g=f+1;if(c<g)break;for(e=g;e<=c;e+=1){h=a[f][e],a[f][e]=0;for(d=1;d<=f;d+=1)a[d][e]=a[d][e]+h*a[d][f]}}}function e(a,b,c,d){var e,f,g,h;for(f=1;f<=c;f+=1){h=0;for(e=1;e<f;e+=1)h+=a[e][f]*d[e];d[f]=(d[f]-h)/a[f][f]}for(g=1;g<=c;g+=1){f=c+1-g,d[f]=d[f]/a[f][f],h=-d[f];for(e=1;e<f;e+=1)d[e]=d[e]+h*a[e][f]}}function f(a,b,c,d){var e,f,g,h,i,j;for(f=1;f<=c;f+=1){d[1]=f,j=0,g=f-1;if(g<1){j=a[f][f]-j;if(j<=0)break;a[f][f]=Math.sqrt(j)}else{for(h=1;h<=g;h+=1){i=a[h][f];for(e=1;e<h;e+=1)i-=a[e][f]*a[e][h];i/=a[h][h],a[h][f]=i,j+=i*i}j=a[f][f]-j;if(j<=0)break;a[f][f]=Math.sqrt(j)}d[1]=0}}function g(a,b,c,g,h,i,j,k,l,m,n,o,p,q,r,s){function U(){q[1]=q[1]+1,v=C;for(t=1;t<=m;t+=1){v+=1,I=-k[t];for(u=1;u<=g;u+=1)I+=j[u][t]*h[u];Math.abs(I)<Q&&(I=0);if(t>n)r[v]=I;else{r[v]=-Math.abs(I);if(I>0){for(u=1;u<=g;u+=1)j[u][t]=-j[u][t];k[t]=-k[t]}}}for(t=1;t<=p;t+=1)r[C+o[t]]=0;E=0,H=0;for(t=1;t<=m;t+=1)r[C+t]<H*r[G+t]&&(E=t,H=r[C+t]/r[G+t]);return E===0?999:0}function V(){for(t=1;t<=g;t+=1){I=0;for(u=1;u<=g;u+=1)I+=a[u][t]*j[u][E];r[t]=I}w=z;for(t=1;t<=g;t+=1)r[w+t]=0;for(u=p+1;u<=g;u+=1)for(t=1;t<=g;t+=1)r[w+t]=r[w+t]+a[t][u]*r[u];O=!0;for(t=p;t>=1;t-=1){I=r[t],v=B+t*(t+3)/2,w=v-t;for(u=t+1;u<=p;u+=1)I-=r[v]*r[A+u],v+=u;I/=r[w],r[A+t]=I;if(o[t]<n)break;if(I<0)break;O=!1,y=t}if(!O){J=r[D+y]/r[A+y];for(t=1;t<=p;t+=1){if(o[t]<n)break;if(r[A+t]<0)break;H=r[D+t]/r[A+t],H<J&&(J=H,y=t)}}I=0;for(t=z+1;t<=z+g;t+=1)I+=r[t]*r[t];if(Math.abs(I)<=Q){if(O)return s[1]=1,999;for(t=1;t<=p;t+=1)r[D+t]=r[D+t]-J*r[A+t];return r[D+p+1]=r[D+p+1]+J,700}I=0;for(t=1;t<=g;t+=1)I+=r[z+t]*j[t][E];K=-r[C+E]/I,P=!0,O||J<K&&(K=J,P=!1);for(t=1;t<=g;t+=1)h[t]=h[t]+K*r[z+t],Math.abs(h[t])<Q&&(h[t]=0);i[1]=i[1]+K*I*(K/2+r[D+p+1]);for(t=1;t<=p;t+=1)r[D+t]=r[D+t]-K*r[A+t];r[D+p+1]=r[D+p+1]+K;if(!P){I=-k[E];for(u=1;u<=g;u+=1)I+=h[u]*j[u][E];if(E>n)r[C+E]=I;else{r[C+E]=-Math.abs(I);if(I>0){for(u=1;u<=g;u+=1)j[u][E]=-j[u][E];k[E]=-k[E]}}return 700}p+=1,o[p]=E,v=B+(p-1)*p/2+1;for(t=1;t<=p-1;t+=1)r[v]=r[t],v+=1;if(p===g)r[v]=r[g];else{for(t=g;t>=p+1;t-=1){if(r[t]===0)break;L=Math.max(Math.abs(r[t-1]),Math.abs(r[t])),M=Math.min(Math.abs(r[t-1]),Math.abs(r[t])),r[t-1]>=0?H=Math.abs(L*Math.sqrt(1+M*M/(L*L))):H=-Math.abs(L*Math.sqrt(1+M*M/(L*L))),L=r[t-1]/H,M=r[t]/H;if(L===1)break;if(L===0){r[t-1]=M*H;for(u=1;u<=g;u+=1)H=a[u][t-1],a[u][t-1]=a[u][t],a[u][t]=H}else{r[t-1]=H,N=M/(1+L);for(u=1;u<=g;u+=1)H=L*a[u][t-1]+M*a[u][t],a[u][t]=N*(a[u][t-1]+H)-a[u][t],a[u][t-1]=H}}r[v]=r[p]}return 0}function W(){v=B+y*(y+1)/2+1,w=v+y;if(r[w]===0)return 798;L=Math.max(Math.abs(r[w-1]),Math.abs(r[w])),M=Math.min(Math.abs(r[w-1]),Math.abs(r[w])),r[w-1]>=0?H=Math.abs(L*Math.sqrt(1+M*M/(L*L))):H=-Math.abs(L*Math.sqrt(1+M*M/(L*L))),L=r[w-1]/H,M=r[w]/H;if(L===1)return 798;if(L===0){for(t=y+1;t<=p;t+=1)H=r[w-1],r[w-1]=r[w],r[w]=H,w+=t;for(t=1;t<=g;t+=1)H=a[t][y],a[t][y]=a[t][y+1],a[t][y+1]=H}else{N=M/(1+L);for(t=y+1;t<=p;t+=1)H=L*r[w-1]+M*r[w],r[w]=N*(r[w-1]+H)-r[w],r[w-1]=H,w+=t;for(t=1;t<=g;t+=1)H=L*a[t][y]+M*a[t][y+1],a[t][y+1]=N*(a[t][y]+H)-a[t][y+1],a[t][y]=H}return 0}function X(){w=v-y;for(t=1;t<=y;t+=1)r[w]=r[v],v+=1,w+=1;return r[D+y]=r[D+y+1],o[y]=o[y+1],y+=1,y<p?797:0}function Y(){return r[D+p]=r[D+p+1],r[D+p+1]=0,o[p]=0,p-=1,q[2]=q[2]+1,0}var t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;F=Math.min(g,m),v=2*g+F*(F+5)/2+2*m+1,Q=1e-60;do Q+=Q,R=1+.1*Q,S=1+.2*Q;while(R<=1||S<=1);for(t=1;t<=g;t+=1)r[t]=b[t];for(t=g+1;t<=v;t+=1)r[t]=0;for(t=1;t<=m;t+=1)o[t]=0;x=[];if(s[1]===0){f(a,c,g,x);if(x[1]!==0){s[1]=2;return}e(a,c,g,b),d(a,c,g)}else{for(u=1;u<=g;u+=1){h[u]=0;for(t=1;t<=u;t+=1)h[u]=h[u]+a[t][u]*b[t]}for(u=1;u<=g;u+=1){b[u]=0;for(t=u;t<=g;t+=1)b[u]=b[u]+a[u][t]*h[t]}}i[1]=0;for(u=1;u<=g;u+=1){h[u]=b[u],i[1]=i[1]+r[u]*h[u],r[u]=0;for(t=u+1;t<=g;t+=1)a[t][u]=0}i[1]=-i[1]/2,s[1]=0,z=g,A=z+g,D=A+F,B=D+F+1,C=B+F*(F+1)/2,G=C+m;for(t=1;t<=m;t+=1){I=0;for(u=1;u<=g;u+=1)I+=j[u][t]*j[u][t];r[G+t]=Math.sqrt(I)}p=0,q[1]=0,q[2]=0,T=0;for(;;){T=U();if(T===999)return;for(;;){T=V();if(T===0)break;if(T===999)return;if(T===700)if(y===p)Y();else{for(;;){W(),T=X();if(T!==797)break}Y()}}}}function h(a,d,e,f,h,i){a=b(a),d=b(d),e=b(e);var j,k,l,m,n,o=[],p=[],q=[],r=[],s=[],t;h=h||0,i=i?b(i):[undefined,0],f=f?b(f):[],k=a.length-1,l=e[1].length-1;if(!f)for(j=1;j<=l;j+=1)f[j]=0;for(j=1;j<=l;j+=1)p[j]=0;m=0,n=Math.min(k,l);for(j=1;j<=k;j+=1)q[j]=0;o[1]=0;for(j=1;j<=2*k+n*(n+5)/2+2*l+1;j+=1)r[j]=0;for(j=1;j<=2;j+=1)s[j]=0;return g(a,d,k,k,q,o,e,f,k,l,h,p,m,s,r,i),t="",i[1]===1&&(t="constraints are inconsistent, no solution!"),i[1]===2&&(t="matrix D in quadratic function is not positive definite!"),{solution:c(q),value:c(o),unconstrained_solution:c(d),iterations:c(s),iact:c(p),message:t}}a.solveQP=h}(b),b.svd=function(c){function s(a,b){return a=Math.abs(a),b=Math.abs(b),a>b?a*Math.sqrt(1+b*b/a/a):b==0?a:b*Math.sqrt(1+a*a/b/b)}var d,e=b.epsilon,f=1e-64/e,g=50,h=0,i=0,j=0,k=0,l=0,m=b.clone(c),n=m.length,o=m[0].length;if(n<o)throw"Need more rows than columns";var p=new Array(o),q=new Array(o);for(i=0;i<o;i++)p[i]=q[i]=0;var r=b.rep([o,o],0),t=0,u=0,v=0,w=0,x=0,y=0,z=0;for(i=0;i<o;i++){p[i]=u,z=0,l=i+1;for(j=i;j<n;j++)z+=m[j][i]*m[j][i];if(z<=f)u=0;else{t=m[i][i],u=Math.sqrt(z),t>=0&&(u=-u),v=t*u-z,m[i][i]=t-u;for(j=l;j<o;j++){z=0;for(k=i;k<n;k++)z+=m[k][i]*m[k][j];t=z/v;for(k=i;k<n;k++)m[k][j]+=t*m[k][i]}}q[i]=u,z=0;for(j=l;j<o;j++)z+=m[i][j]*m[i][j];if(z<=f)u=0;else{t=m[i][i+1],u=Math.sqrt(z),t>=0&&(u=-u),v=t*u-z,m[i][i+1]=t-u;for(j=l;j<o;j++)p[j]=m[i][j]/v;for(j=l;j<n;j++){z=0;for(k=l;k<o;k++)z+=m[j][k]*m[i][k];for(k=l;k<o;k++)m[j][k]+=z*p[k]}}x=Math.abs(q[i])+Math.abs(p[i]),x>w&&(w=x)}for(i=o-1;i!=-1;i+=-1){if(u!=0){v=u*m[i][i+1];for(j=l;j<o;j++)r[j][i]=m[i][j]/v;for(j=l;j<o;j++){z=0;for(k=l;k<o;k++)z+=m[i][k]*r[k][j];for(k=l;k<o;k++)r[k][j]+=z*r[k][i]}}for(j=l;j<o;j++)r[i][j]=0,r[j][i]=0;r[i][i]=1,u=p[i],l=i}for(i=o-1;i!=-1;i+=-1){l=i+1,u=q[i];for(j=l;j<o;j++)m[i][j]=0;if(u!=0){v=m[i][i]*u;for(j=l;j<o;j++){z=0;for(k=l;k<n;k++)z+=m[k][i]*m[k][j];t=z/v;for(k=i;k<n;k++)m[k][j]+=t*m[k][i]}for(j=i;j<n;j++)m[j][i]=m[j][i]/u}else for(j=i;j<n;j++)m[j][i]=0;m[i][i]+=1}e*=w;for(k=o-1;k!=-1;k+=-1)for(var A=0;A<g;A++){var B=!1;for(l=k;l!=-1;l+=-1){if(Math.abs(p[l])<=e){B=!0;break}if(Math.abs(q[l-1])<=e)break}if(!B){h=0,z=1;var C=l-1;for(i=l;i<k+1;i++){t=z*p[i],p[i]=h*p[i];if(Math.abs(t)<=e)break;u=q[i],v=s(t,u),q[i]=v,h=u/v,z=-t/v;for(j=0;j<n;j++)x=m[j][C],y=m[j][i],m[j][C]=x*h+y*z,m[j][i]=-x*z+y*h}}y=q[k];if(l==k){if(y<0){q[k]=-y;for(j=0;j<o;j++)r[j][k]=-r[j][k]}break}if(A>=g-1)throw"Error: no convergence.";w=q[l],x=q[k-1],u=p[k-1],v=p[k],t=((x-y)*(x+y)+(u-v)*(u+v))/(2*v*x),u=s(t,1),t<0?t=((w-y)*(w+y)+v*(x/(t-u)-v))/w:t=((w-y)*(w+y)+v*(x/(t+u)-v))/w,h=1,z=1;for(i=l+1;i<k+1;i++){u=p[i],x=q[i],v=z*u,u=h*u,y=s(t,v),p[i-1]=y,h=t/y,z=v/y,t=w*h+u*z,u=-w*z+u*h,v=x*z,x*=h;for(j=0;j<o;j++)w=r[j][i-1],y=r[j][i],r[j][i-1]=w*h+y*z,r[j][i]=-w*z+y*h;y=s(t,v),q[i-1]=y,h=t/y,z=v/y,t=h*u+z*x,w=-z*u+h*x;for(j=0;j<n;j++)x=m[j][i-1],y=m[j][i],m[j][i-1]=x*h+y*z,m[j][i]=-x*z+y*h}p[l]=0,p[k]=t,q[k]=w}for(i=0;i<q.length;i++)q[i]<e&&(q[i]=0);for(i=0;i<o;i++)for(j=i-1;j>=0;j--)if(q[j]<q[i]){h=q[j],q[j]=q[i],q[i]=h;for(k=0;k<m.length;k++)d=m[k][i],m[k][i]=m[k][j],m[k][j]=d;for(k=0;k<r.length;k++)d=r[k][i],r[k][i]=r[k][j],r[k][j]=d;i=j}return{U:m,S:q,V:r}},a.utils=a.utils||{},a.utils.mean=function(a){var b=0;for(var c=0;c<a.length;c++)b+=a[c];return b/a.length},a.utils.checkConvergence=function(a,b,c,d){var e=1e-8;return b!=null&&Math.abs(a-b)<e||c>d},a.utils.softThreshold=function(a,b){var c=Math.abs(a);return b<c?a>0?a-b:a+b:0},a.utils.makeArray=function(a,b){var c=[];for(var d=0;d<a;d++)c.push(b);return c},a.utils.zeros=function(b){return a.utils.makeArray(b,0)},a.utils.map=function(a,b){var c=[];for(var d=0;d<a.length;d++)c.push(b(a[d]));return c},a.GLM=function(c,d){c||(c=a.families.Gaussian()),d||(d="none");var e={};return e.family=c,e.weights=null,e.fit=function(b,c){return e.weights=a.optimization.IRLS(b,c,e.family),this},e.predict=function(a){var c=b.dot(a,e.weights);return e.family.fitted(c)},e},a.families=a.families||{},a.families.Binomial=function(b){b||(b=a.links.Logit());var c={};return c.initialMu=function(a){var b=[];for(var c=0;c<a.length;c++)b.push((a[c]+.5)/2);return b},c.deviance=function(a,b){var c=0;for(var d=0;d<b.length;d++){var e=a[d]==1?1:0;c+=e*Math.log(b[d]+1e-200)+(1-e)*Math.log(1-b[d]+1e-200)}return 2*c},c.link=b,c.predict=function(a){return c.link.f(a)},c.fitted=function(a){return c.link.inverse(a)},c},a.families.Gaussian=function(b){b||(b=a.links.Identity());var c={};return c.deviance=function(a,b){var c=0;for(var d=0;d<a.length;d++)c+=Math.pow(a[d]-b[d],2);return c},c.initialMu=function(b){var c=a.utils.mean(b),d=[];for(var e=0;e<b.length;e++)d.push((b[e]-c)/2);return d},c.link=b,c.predict=function(a){return c.link.f(a)},c.fitted=function(a){return c.link.inverse(a)},c},a.links=a.links||{},a.links.Logit=function(){var b={f:function(b){return a.utils.map(b,function(a){return Math.log(a/(1-a))})},inverse:function(b){return a.utils.map(b,function(a){var b=Math.exp(a);return b/(1+b)})},derivative:function(b){return a.utils.map(b,function(a){return 1/(a*(1-a))})}};return b},a.links.Power=function(b){var c={f:function(c){return a.utils.map(c,function(a){return Math.pow(a,b)})},inverse:function(c){return a.utils.map(c,function(a){return Math.pow(a,1/b)})},derivative:function(c){return a.utils.map(c,function(a){return b*Math.pow(a,b-1)})}};return c},a.links.Identity=function(){return a.links.Power(1)},a.links.Log=function(){var b={f:function(b){return a.utils.map(b,Math.log)},inverse:function(b){return a.utils.map(b,Math.exp)},derivative:function(b){return a.utils.map(b,function(a){return 1/a})}};return b},a.optimization=a.optimization||{},a.optimization.IRLS=function(c,d,e){function f(a,e){function f(a){var c=b.identity(a.length);for(var d=0;d<a.length;d++)c[d][d]/=a[d];return c}var g=b.svd(b.dot(b.transpose(d),d)),h=g.U,i=f(g.S),j=g.V,k=b.dot(h,b.dot(i,b.inv(j))),l=b.dot(b.dot(k,b.transpose(d)),c);return l}var g=!1,h=0,i=5,j=e.initialMu(c),k=e.predict(j),l=e.deviance(c,j),m=null;while(!g){oldDeviance=l;var n=0,o=e.link.derivative(j);for(var p=0;p<c.length;p++)n+=o[p]*(c[p]-j[p]);var q=a.utils.map(k,function(a){return a+n});m=f(q,d),k=b.dot(d,m),j=e.fitted(k),l=e.deviance(c,j),g=a.utils.checkConvergence(l,oldDeviance,h,i),h+=1}return m}})(this);